!function(){function e(e){}function t(e,t){function n(e,t){t.otherwise("/"),e.state("start",{url:"/",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/start.html",controller:"mainController"}}}).state("children",{url:"/children",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/children.html",controller:"mainController"}}}).state("childIncome",{url:"/childIncome",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/childIncome.html",controller:"mainController"}}}).state("household",{url:"/household",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/household.html",controller:"mainController"}}}).state("signature",{url:"/signature",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/signature.html",controller:"mainController"}}}).state("confirmation",{url:"/confirmation",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/confirmation.html",controller:"mainController"}}}).state("export",{url:"/export",templateUrl:"../views/export.html",controller:"mainController"}).state("styleguide",{url:"/styleguide",templateUrl:"../views/styleguide.html",controller:"mainController"}).state("signup",{url:"/signup",templateUrl:"../views/signup.html"}).state("login",{url:"/login",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/login.html",controller:"loginController"}}}).state("soFar",{url:"/so-far",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/soFar.html",controller:"mainController"}}})}n(e,t)}angular.module("eatChallengeApp",["ngMaterial","ui.router"]).config(t).config(e),e.$inject=["$mdThemingProvider"],t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(){console.log("running ok")}angular.module("eatChallengeApp").controller("loginController",[e])}(),function(){function e(e,t,n,o,r,l,i,s){function a(){s.updateRequiredSections(o.household);s.navigateToNext(l.$current.self.name)}o.schoolDistrict="Oakland Unified School District",o.studentStatuses=["in school","home schooled","some other status"],o.household=i.get(),o.navigateToNextSection=a,o.$watch("household.childCount",function(e){for(;e>o.household.children.length;)o.household.incrementChildCount()}),o.$watch("household.otherMembersCount",function(e){for(;e>o.household.otherMembers.length;)o.household.incrementOtherMembersCount()}),r.$on("$stateChangeSuccess",function(){document.body.scrollTop=document.documentElement.scrollTop=0}),r.$on("$stateChangeSuccess",function(e,t,n,o,r){s.previousState=o.name,s.currentState=t.name,console.log("Previous state:"+s.previousState),console.log("Current state:"+s.currentState)})}angular.module("eatChallengeApp").controller("mainController",e),e.$inject=["$interval","$mdDialog","$mdMedia","$rootScope","$scope","$state","Household","Sections"]}(),function(){function e(e,t,n){var o=e;o.currentState=t.$current.self.name,o.sections=n.sections}angular.module("eatChallengeApp").controller("sideNavController",e),e.$inject=["$scope","$state","Sections"]}(),function(){function e(){var e={scope:{member:"="},restrict:"A",replace:!0,templateUrl:"../views/income.html",link:t};return e}function t(e){e.incomeSources={work:{vaule:"work",label:"Earnings from work",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A child has a job where they earn salary or wages ",otherMember:""}},socialSecurity:{vaule:"socialSecurity",label:"Social Security Disability Payments or Survivorâ€™s Benefits ",frequency:["monthly"],annotation:{child:"A child is blind or disabled and receives Social Security benefits.",otherMember:""}},otherPerson:{vaule:"otherPerson",label:"Income from persons outside the household",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A friend or extended family member regularly gives a child spending money",otherMember:""}},otherSource:{vaule:"otherSource",label:"Income from any other source",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A child receives income from a private pension fund, annuity, or trust",otherMember:""}}},0===e.member.incomeSources.length&&(e.member.incomeSources=[],Object.keys(e.incomeSources).forEach(function(t){e.member.incomeSources.push({type:t,amount:null,frequency:null})}))}angular.module("eatChallengeApp").directive("incomeQuestions",e)}(),function(){function e(){return{scope:{model:"="},restrict:"A",replace:!0,templateUrl:"../views/yesno.html"}}angular.module("eatChallengeApp").directive("yesNoInput",e)}(),function(){function e(e){function t(){return r?r:(r=Object.create(i),r.init(),r)}function n(){return e.post("/household",r)}function o(){var e={};return e}this.get=t,this.save=n,this.clear=o;var r,l={init:function(){this.incomeSourceCount=0,this.incomeSources=[]},incrementIncomeSources:function(){for(this.incomeSourceCount++;this.incomeSourceCount>this.incomeSources.length;)this.incomeSources.push({})}},i={init:function(){this.children=[],this.childCount=0,this.incrementChildCount(),this.otherMembers=[],this.otherMembersCount=0,this.incrementOtherMembersCount()},incrementChildCount:function(){for(this.childCount++;this.childCount>this.children.length;){var e=Object.create(l);e.init(),e.isChild=!0,e.specialStatus={},e.assistanceProgram={},this.children.push(e)}},incrementOtherMembersCount:function(){for(this.otherMembersCount++;this.otherMembersCount>this.otherMembers.length;){var e=Object.create(l);e.init(),e.isChild=!1,this.otherMembers.push(e)}}};return this}angular.module("eatChallengeApp").service("Household",e),e.$inject=["$http"]}(),function(){function e(e){function t(e){for(var t,n=!1,o=0,i=!0,s=0;s<e.children.length;s++){if(t=e.children[s],t.assistanceProgram.participant){n=!0;break}t.specialStatus.fosterChild&&o++}(n||e.children.length===o)&&(i=!1),i?r.forEach(function(e){e.required=!0}):(l.childIncome.required=!1,l.household.required=!1)}function n(e){for(var t=_.findIndex(r,function(t){return t.state===e}),n=t+1;n<r.length;n++)if(r[n].required)return r[n].state;return"confirmation"}function o(t){var o=n(t);e.go(o)}var r=[{label:"Children",state:"children",completed:!1,required:!0},{label:"Child Income",state:"childIncome",completed:!1,required:!0},{label:"Household",state:"household",completed:!1,required:!0},{label:"Sign and Confirm",state:"signature",completed:!1,required:!0}],l=_.indexBy(r,"state"),i={sections:r,indexedSections:l,navigateToNext:o,updateRequiredSections:t};return i}angular.module("eatChallengeApp").service("Sections",e),e.$inject=["$state"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luLmpzIiwiY29udHJvbGxlcnMvbWFpbi5qcyIsImNvbnRyb2xsZXJzL3NpZGVuYXYuanMiLCJkaXJlY3RpdmVzL2luY29tZS5qcyIsImRpcmVjdGl2ZXMveWVzbm8uanMiLCJzZXJ2aWNlcy9ob3VzZWhvbGQuanMiLCJzZXJ2aWNlcy9zZWN0aW9ucy5qcyJdLCJuYW1lcyI6WyJtYXRlcmlhbERlc2lnblRoZW1lciIsIiRtZFRoZW1pbmdQcm92aWRlciIsInJvdXRlckNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwicm91dGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsInNpZGUtbmF2IiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwibWFpbiIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkaW5qZWN0IiwibG9naW5Db250cm9sbGVyIiwiY29uc29sZSIsImxvZyIsIm1haW5Db250cm9sbGVyIiwiJGludGVydmFsIiwiJG1kRGlhbG9nIiwiJG1kTWVkaWEiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiSG91c2Vob2xkIiwiU2VjdGlvbnMiLCJuYXZpZ2F0ZVRvTmV4dFNlY3Rpb24iLCJ1cGRhdGVSZXF1aXJlZFNlY3Rpb25zIiwiaG91c2Vob2xkIiwibmF2aWdhdGVUb05leHQiLCIkY3VycmVudCIsInNlbGYiLCJuYW1lIiwic2Nob29sRGlzdHJpY3QiLCJzdHVkZW50U3RhdHVzZXMiLCJnZXQiLCIkd2F0Y2giLCJuZXdWYWwiLCJjaGlsZHJlbiIsImxlbmd0aCIsImluY3JlbWVudENoaWxkQ291bnQiLCJvdGhlck1lbWJlcnMiLCJpbmNyZW1lbnRPdGhlck1lbWJlcnNDb3VudCIsIiRvbiIsImRvY3VtZW50IiwiYm9keSIsInNjcm9sbFRvcCIsImRvY3VtZW50RWxlbWVudCIsImV2IiwidG8iLCJ0b1BhcmFtcyIsImZyb20iLCJmcm9tUGFyYW1zIiwicHJldmlvdXNTdGF0ZSIsImN1cnJlbnRTdGF0ZSIsInNpZGVOYXZDb250cm9sbGVyIiwidm0iLCJzZWN0aW9ucyIsImluY29tZURpcmVjdGl2ZSIsImRpcmVjdGl2ZSIsInNjb3BlIiwibWVtYmVyIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwibGluayIsImluY29tZVNvdXJjZXMiLCJ3b3JrIiwidmF1bGUiLCJsYWJlbCIsImZyZXF1ZW5jeSIsImFubm90YXRpb24iLCJjaGlsZCIsIm90aGVyTWVtYmVyIiwic29jaWFsU2VjdXJpdHkiLCJvdGhlclBlcnNvbiIsIm90aGVyU291cmNlIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJpbmNvbWVTb3VyY2UiLCJwdXNoIiwidHlwZSIsImFtb3VudCIsInllc05vSW5wdXQiLCJtb2RlbCIsImhvdXNlaG9sZFNlcnZpY2UiLCIkaHR0cCIsImNyZWF0ZSIsImluaXQiLCJzYXZlIiwicG9zdCIsImNsZWFyIiwidGhpcyIsIlBlcnNvbiIsImluY29tZVNvdXJjZUNvdW50IiwiaW5jcmVtZW50SW5jb21lU291cmNlcyIsImNoaWxkQ291bnQiLCJvdGhlck1lbWJlcnNDb3VudCIsIm5ld0NoaWxkIiwiaXNDaGlsZCIsInNwZWNpYWxTdGF0dXMiLCJhc3Npc3RhbmNlUHJvZ3JhbSIsIm5ld01lbWJlciIsInNlcnZpY2UiLCJzZWN0aW9uc1NlcnZpY2UiLCJjdXJyZW50Q2hpbGQiLCJhc3Npc3RhbmNlUHJvZ3JhbUhvdXNlaG9sZCIsImZvc3RlckNoaWxkQ291bnQiLCJzaG91bGRNZWFuc1Rlc3QiLCJpIiwicGFydGljaXBhbnQiLCJmb3N0ZXJDaGlsZCIsInNlY3Rpb24iLCJyZXF1aXJlZCIsImluZGV4ZWRTZWN0aW9ucyIsImZpbmROZXh0IiwiY3VycmVudEluZGV4IiwiXyIsImZpbmRJbmRleCIsIm5leHRTZWN0aW9uIiwiZ28iLCJjb21wbGV0ZWQiLCJpbmRleEJ5Il0sIm1hcHBpbmdzIjoiQ0FBQSxXQVFBLFFBQUFBLEdBQUFDLElBaUJB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LEVBQUFLLFFBQUFqRSxFQUFBLFNBNERBOEMsR0FDQTlDLFNBQUFBLEVBQ0F5RCxnQkFBQUEsRUFDQXJGLGVBQUFBLEVBQ0FGLHVCQUFBQSxFQUdBLE9BQUE0RSxHQXRHQTdGLFFBQ0FDLE9BQUEsbUJBQ0E0RixRQUFBLFdBQUFDLEdBRUFBLEVBQUEzRixTQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnLFsnbmdNYXRlcmlhbCcsJ3VpLnJvdXRlciddKVxuICAgIC5jb25maWcocm91dGVyQ29uZmlnKVxuICAgIC5jb25maWcobWF0ZXJpYWxEZXNpZ25UaGVtZXIpO1xuXG4gICAgbWF0ZXJpYWxEZXNpZ25UaGVtZXIuJGluamVjdCA9IFsnJG1kVGhlbWluZ1Byb3ZpZGVyJ107XG4gICAgZnVuY3Rpb24gbWF0ZXJpYWxEZXNpZ25UaGVtZXIoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XG4gICAgICAgIC8vICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnbGlnaHQtYmx1ZScpO1xuICAgICAgICAvLyAucHJpbWFyeVBhbGV0dGUoJ3BpbmsnLCB7XG4gICAgICAgIC8vICAgJ2RlZmF1bHQnOiAnNDAwJywgLy8gYnkgZGVmYXVsdCB1c2Ugc2hhZGUgNDAwIGZyb20gdGhlIHBpbmsgcGFsZXR0ZSBmb3IgcHJpbWFyeSBpbnRlbnRpb25zXG4gICAgICAgIC8vICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcbiAgICAgICAgLy8gICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xuICAgICAgICAvLyAgICdodWUtMyc6ICdBMTAwJyAvLyB1c2Ugc2hhZGUgQTEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0zPC9jb2RlPiBjbGFzc1xuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAvLyBJZiB5b3Ugc3BlY2lmeSBsZXNzIHRoYW4gYWxsIG9mIHRoZSBrZXlzLCBpdCB3aWxsIGluaGVyaXQgZnJvbSB0aGVcbiAgICAgICAgLy8gLy8gZGVmYXVsdCBzaGFkZXNcbiAgICAgICAgLy8gLmFjY2VudFBhbGV0dGUoJ3B1cnBsZScsIHtcbiAgICAgICAgLy8gICAnZGVmYXVsdCc6ICcyMDAnIC8vIHVzZSBzaGFkZSAyMDAgZm9yIGRlZmF1bHQsIGFuZCBrZWVwIGFsbCBvdGhlciBzaGFkZXMgdGhlIHNhbWVcbiAgICAgICAgLy8gfSk7XG4gICAgfVxuXG4gICAgcm91dGVyQ29uZmlnLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gcm91dGVyQ29uZmlnICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgICAgICAgcm91dGVyKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpO1xuXG4gICAgICAgIC8vLy8vLy8vLy9cbiAgICAgICAgZnVuY3Rpb24gcm91dGVyKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnc3RhcnQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zdGFydC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NoaWxkcmVuJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jaGlsZHJlbicsXG4gICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAnbWFpbic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9jaGlsZHJlbi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21haW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NoaWxkSW5jb21lJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jaGlsZEluY29tZScsXG4gICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lkZU5hdi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3NpZGVOYXZDb250cm9sbGVyJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2NoaWxkSW5jb21lLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2hvdXNlaG9sZCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvaG91c2Vob2xkJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MvaG91c2Vob2xkLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ3NpZ25hdHVyZScsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvc2lnbmF0dXJlJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lnbmF0dXJlLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2NvbmZpcm1hdGlvbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvY29uZmlybWF0aW9uJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MvY29uZmlybWF0aW9uLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2V4cG9ydCcsIHtcbiAgICAgICAgICAgICAgdXJsOiAnL2V4cG9ydCcsXG4gICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MvZXhwb3J0Lmh0bWwnLFxuICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnc3R5bGVndWlkZScsIHtcbiAgICAgICAgICAgICAgdXJsOiAnL3N0eWxlZ3VpZGUnLFxuICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3N0eWxlZ3VpZGUuaHRtbCcsXG4gICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdzaWdudXAnLCB7XG4gICAgICAgICAgICAgIHVybDogJy9zaWdudXAnLFxuICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZ251cC5odG1sJyxcbiAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdsb2dpbicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgICAgIHZpZXdzOntcbiAgICAgICAgICAgICAgICAgICAgJ3NpZGUtbmF2Jzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnbWFpbic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ2xvZ2luQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnc29GYXInLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL3NvLWZhcicsXG4gICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lkZU5hdi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3NpZGVOYXZDb250cm9sbGVyJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NvRmFyLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgYW5ndWxhclxuICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgIC5jb250cm9sbGVyKCdsb2dpbkNvbnRyb2xsZXInLCBbbG9naW5Db250cm9sbGVyXSk7XG5cbiAgICBmdW5jdGlvbiBsb2dpbkNvbnRyb2xsZXIoKSB7XG4gICAgICAgIHZhciBsb2dpblZNID0gdGhpcztcbiAgICAgICAgY29uc29sZS5sb2coJ3J1bm5pbmcgb2snKTtcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdtYWluQ29udHJvbGxlcicsIG1haW5Db250cm9sbGVyKTtcblxuICAgIG1haW5Db250cm9sbGVyLiRpbmplY3QgPSBbJyRpbnRlcnZhbCcsICckbWREaWFsb2cnLCAnJG1kTWVkaWEnLCAnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJHN0YXRlJywgJ0hvdXNlaG9sZCcsICdTZWN0aW9ucyddO1xuXG4gICAgZnVuY3Rpb24gbWFpbkNvbnRyb2xsZXIgKCRpbnRlcnZhbCwgJG1kRGlhbG9nLCAkbWRNZWRpYSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsIEhvdXNlaG9sZCwgU2VjdGlvbnMpIHtcbiAgICAgICAgLy8gVE9ETzogcmVwbGFjZSBzY29wZSB3aXRoIHZtXG4gICAgICAgICRzY29wZS5zY2hvb2xEaXN0cmljdCA9ICdPYWtsYW5kIFVuaWZpZWQgU2Nob29sIERpc3RyaWN0JztcbiAgICAgICAgJHNjb3BlLnN0dWRlbnRTdGF0dXNlcyA9IFsnaW4gc2Nob29sJywgJ2hvbWUgc2Nob29sZWQnLCAnc29tZSBvdGhlciBzdGF0dXMnXTtcblxuICAgICAgICAkc2NvcGUuaG91c2Vob2xkID0gSG91c2Vob2xkLmdldCgpO1xuICAgICAgICAkc2NvcGUubmF2aWdhdGVUb05leHRTZWN0aW9uID0gbmF2aWdhdGVUb05leHRTZWN0aW9uO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdob3VzZWhvbGQuY2hpbGRDb3VudCcsIGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgd2hpbGUgKG5ld1ZhbCA+ICRzY29wZS5ob3VzZWhvbGQuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhvdXNlaG9sZC5pbmNyZW1lbnRDaGlsZENvdW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2hvdXNlaG9sZC5vdGhlck1lbWJlcnNDb3VudCcsIGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgd2hpbGUgKG5ld1ZhbCA+ICRzY29wZS5ob3VzZWhvbGQub3RoZXJNZW1iZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ob3VzZWhvbGQuaW5jcmVtZW50T3RoZXJNZW1iZXJzQ291bnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVE9ETzogbW92ZSB0aGlzIHRvIGNvbmZpZyBvciBzb21ldGhpbmdcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vICRyb290U2NvcGUucHJldmlvdXNTdGF0ZTtcbiAgICAgICAgLy8gJHJvb3RTY29wZS5jdXJyZW50U3RhdGU7XG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VTdWNjZXNzJywgZnVuY3Rpb24oZXYsIHRvLCB0b1BhcmFtcywgZnJvbSwgZnJvbVBhcmFtcykge1xuICAgICAgICAgICAgU2VjdGlvbnMucHJldmlvdXNTdGF0ZSA9IGZyb20ubmFtZTtcbiAgICAgICAgICAgIFNlY3Rpb25zLmN1cnJlbnRTdGF0ZSA9IHRvLm5hbWU7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnUHJldmlvdXMgc3RhdGU6JyArIFNlY3Rpb25zLnByZXZpb3VzU3RhdGUpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0N1cnJlbnQgc3RhdGU6JysgU2VjdGlvbnMuY3VycmVudFN0YXRlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gbmF2aWdhdGVUb05leHRTZWN0aW9uKCkge1xuICAgICAgICAgICAgdmFyIHVwZGF0ZWQgPSBTZWN0aW9ucy51cGRhdGVSZXF1aXJlZFNlY3Rpb25zKCRzY29wZS5ob3VzZWhvbGQpO1xuICAgICAgICAgICAgU2VjdGlvbnMubmF2aWdhdGVUb05leHQoJHN0YXRlLiRjdXJyZW50LnNlbGYubmFtZSk7XG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ3NpZGVOYXZDb250cm9sbGVyJywgc2lkZU5hdkNvbnRyb2xsZXIpO1xuXG4gICAgc2lkZU5hdkNvbnRyb2xsZXIuJGluamVjdCA9IFsnJHNjb3BlJywgJyRzdGF0ZScsICdTZWN0aW9ucyddO1xuXG4gICAgZnVuY3Rpb24gc2lkZU5hdkNvbnRyb2xsZXIgKCRzY29wZSwgJHN0YXRlLCBTZWN0aW9ucykge1xuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9ICRzY29wZTtcblxuICAgICAgICB2bS5jdXJyZW50U3RhdGUgPSAkc3RhdGUuJGN1cnJlbnQuc2VsZi5uYW1lO1xuICAgICAgICB2bS5zZWN0aW9ucyA9IFNlY3Rpb25zLnNlY3Rpb25zO1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLmRpcmVjdGl2ZSgnaW5jb21lUXVlc3Rpb25zJywgaW5jb21lRGlyZWN0aXZlKTtcblxuICAgIGZ1bmN0aW9uIGluY29tZURpcmVjdGl2ZSgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbWVtYmVyOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MvaW5jb21lLmh0bWwnLFxuICAgICAgICAgICAgbGluazogbGlua1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgfVxuXG4gICAgLy8gbGluay4kaW5qZWN0ID0gWydzY29wZSddO1xuXG4gICAgZnVuY3Rpb24gbGluayhzY29wZSkge1xuICAgICAgICBzY29wZS5pbmNvbWVTb3VyY2VzID0ge1xuICAgICAgICAgICAgd29yazoge1xuICAgICAgICAgICAgICAgIHZhdWxlOid3b3JrJyxcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0Vhcm5pbmdzIGZyb20gd29yaycsXG4gICAgICAgICAgICAgICAgZnJlcXVlbmN5OiBbJ3dlZWtseScsICdiaXdlZWtseScsICcyeCBtb250aCcsICdtb250aGx5J10sXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZDogJ0EgY2hpbGQgaGFzIGEgam9iIHdoZXJlIHRoZXkgZWFybiBzYWxhcnkgb3Igd2FnZXMgJyxcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJNZW1iZXI6ICcnLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzb2NpYWxTZWN1cml0eToge1xuICAgICAgICAgICAgICAgIHZhdWxlOidzb2NpYWxTZWN1cml0eScsXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdTb2NpYWwgU2VjdXJpdHkgRGlzYWJpbGl0eSBQYXltZW50cyBvciBTdXJ2aXZvcuKAmXMgQmVuZWZpdHMgJyxcbiAgICAgICAgICAgICAgICBmcmVxdWVuY3k6IFsnbW9udGhseSddLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQ6ICdBIGNoaWxkIGlzIGJsaW5kIG9yIGRpc2FibGVkIGFuZCByZWNlaXZlcyBTb2NpYWwgU2VjdXJpdHkgYmVuZWZpdHMuJyxcbiAgICAgICAgICAgICAgICAgICAgLy8gJyBBIHBhcmVudCBpcyBkaXNhYmxlZCwgcmV0aXJlZCwgb3IgZGVjZWFzZWQsIGFuZCB0aGVpciBjaGlsZCByZWNlaXZlcyBzb2NpYWwgc2VjdXJpdHkgYmVuZWZpdHMnLFxuICAgICAgICAgICAgICAgICAgICBvdGhlck1lbWJlcjogJycsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG90aGVyUGVyc29uOiB7XG4gICAgICAgICAgICAgICAgdmF1bGU6J290aGVyUGVyc29uJyxcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0luY29tZSBmcm9tIHBlcnNvbnMgb3V0c2lkZSB0aGUgaG91c2Vob2xkJyxcbiAgICAgICAgICAgICAgICBmcmVxdWVuY3k6IFsnd2Vla2x5JywgJ2Jpd2Vla2x5JywgJzJ4IG1vbnRoJywgJ21vbnRobHknXSxcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkOiAnQSBmcmllbmQgb3IgZXh0ZW5kZWQgZmFtaWx5IG1lbWJlciByZWd1bGFybHkgZ2l2ZXMgYSBjaGlsZCBzcGVuZGluZyBtb25leScsXG4gICAgICAgICAgICAgICAgICAgIG90aGVyTWVtYmVyOiAnJyxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3RoZXJTb3VyY2U6IHtcbiAgICAgICAgICAgICAgICB2YXVsZTonb3RoZXJTb3VyY2UnLFxuICAgICAgICAgICAgICAgIGxhYmVsOiAnSW5jb21lIGZyb20gYW55IG90aGVyIHNvdXJjZScsXG4gICAgICAgICAgICAgICAgZnJlcXVlbmN5OiBbJ3dlZWtseScsICdiaXdlZWtseScsICcyeCBtb250aCcsICdtb250aGx5J10sXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZDogJ0EgY2hpbGQgcmVjZWl2ZXMgaW5jb21lIGZyb20gYSBwcml2YXRlIHBlbnNpb24gZnVuZCwgYW5udWl0eSwgb3IgdHJ1c3QnLFxuICAgICAgICAgICAgICAgICAgICBvdGhlck1lbWJlcjogJycsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIGlmIChzY29wZS5tZW1iZXIuaW5jb21lU291cmNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHNjb3BlLm1lbWJlci5pbmNvbWVTb3VyY2VzID0gW107XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhzY29wZS5pbmNvbWVTb3VyY2VzKS5mb3JFYWNoKGZ1bmN0aW9uKGluY29tZVNvdXJjZSkge1xuICAgICAgICAgICAgICAgIHNjb3BlLm1lbWJlci5pbmNvbWVTb3VyY2VzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBpbmNvbWVTb3VyY2UsXG4gICAgICAgICAgICAgICAgICAgIGFtb3VudDogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZnJlcXVlbmN5OiBudWxsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLmRpcmVjdGl2ZSgneWVzTm9JbnB1dCcsIHllc05vSW5wdXQpO1xuXG4gICAgZnVuY3Rpb24geWVzTm9JbnB1dCAoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG1vZGVsOiAnPSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxuICAgICAgICAgICAgcmVwbGFjZTogdHJ1ZSxcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MveWVzbm8uaHRtbCcsXG4gICAgICAgIH07XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLnNlcnZpY2UoJ0hvdXNlaG9sZCcsIGhvdXNlaG9sZFNlcnZpY2UpO1xuXG4gICAgaG91c2Vob2xkU2VydmljZS4kaW5qZWN0ID0gWyckaHR0cCddO1xuXG4gICAgZnVuY3Rpb24gaG91c2Vob2xkU2VydmljZSgkaHR0cCkge1xuICAgICAgICB0aGlzLmdldCA9IGdldDtcbiAgICAgICAgdGhpcy5zYXZlID0gc2F2ZTtcbiAgICAgICAgdGhpcy5jbGVhciA9IGNsZWFyO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICB2YXIgUGVyc29uID0ge1xuICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmNvbWVTb3VyY2VDb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmNvbWVTb3VyY2VzID0gW107XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBpbmNyZW1lbnRJbmNvbWVTb3VyY2VzOiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluY29tZVNvdXJjZUNvdW50Kys7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMuaW5jb21lU291cmNlQ291bnQgPiB0aGlzLmluY29tZVNvdXJjZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuaW5jb21lU291cmNlcy5wdXNoKHt9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIEhvdXNlaG9sZCA9IHtcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZENvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmluY3JlbWVudENoaWxkQ291bnQoKTtcblxuICAgICAgICAgICAgICAgIHRoaXMub3RoZXJNZW1iZXJzID0gW107XG4gICAgICAgICAgICAgICAgdGhpcy5vdGhlck1lbWJlcnNDb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmNyZW1lbnRPdGhlck1lbWJlcnNDb3VudCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY3JlbWVudENoaWxkQ291bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRDb3VudCsrO1xuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmNoaWxkQ291bnQgPiB0aGlzLmNoaWxkcmVuLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3Q2hpbGQgPSBPYmplY3QuY3JlYXRlKFBlcnNvbik7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkLmluaXQoKTtcblxuICAgICAgICAgICAgICAgICAgICAvL2FkZCBjaGlsZCBzcGVjaWZpYyBmaWVsZHNcbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGQuaXNDaGlsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkLnNwZWNpYWxTdGF0dXMgPSB7fTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGQuYXNzaXN0YW5jZVByb2dyYW0gPSB7fTtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLmNoaWxkcmVuLnB1c2gobmV3Q2hpbGQpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNyZW1lbnRPdGhlck1lbWJlcnNDb3VudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vdGhlck1lbWJlcnNDb3VudCsrO1xuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLm90aGVyTWVtYmVyc0NvdW50ID4gdGhpcy5vdGhlck1lbWJlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdNZW1iZXIgPSBPYmplY3QuY3JlYXRlKFBlcnNvbik7XG4gICAgICAgICAgICAgICAgICAgIG5ld01lbWJlci5pbml0KCk7XG4gICAgICAgICAgICAgICAgICAgIG5ld01lbWJlci5pc0NoaWxkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMub3RoZXJNZW1iZXJzLnB1c2gobmV3TWVtYmVyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgaG91c2Vob2xkO1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcbiAgICAgICAgICAgIGlmIChob3VzZWhvbGQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaG91c2Vob2xkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvL1RPRE86IGlmIHRoZXJlJ3MgYSB1c2VyaWQsIHJldHVybiB0aGUgaG91c2Vob2xkIGFzc29jaWF0ZWQgd2l0aCBpdFxuICAgICAgICAgICAgLy8gaWYgKHVzZXJpZCkge1xuICAgICAgICAgICAgLy8gICAgIC8vIFRPRE86IGFkZCBlcnJvciBoYW5kbGluZ1xuICAgICAgICAgICAgLy8gICAgICRodHRwLmdldCgnL2hvdXNlaG9sZCcpLnRoZW4oZnVuY3Rpb24oZGF0YSkge1xuICAgICAgICAgICAgLy8gICAgICAgICByZXR1cm4gaG91c2Vob2xkID0gZGF0YTtcbiAgICAgICAgICAgIC8vICAgICB9KTtcbiAgICAgICAgICAgIC8vIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyAgICAgLy8gY3JlYXRlIGEgbmV3IGhvdXNlaG9sZCBpZiBvbmUgZG9lc24ndCBleGlzdFxuICAgICAgICAgICAgaG91c2Vob2xkID0gT2JqZWN0LmNyZWF0ZShIb3VzZWhvbGQpO1xuICAgICAgICAgICAgaG91c2Vob2xkLmluaXQoKTtcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgcmV0dXJuIGhvdXNlaG9sZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHNhdmUoKSB7XG4gICAgICAgICAgICAvLyBUT0RPOiBoYW5kbGUgZXJyb3JzXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnL2hvdXNlaG9sZCcsIGhvdXNlaG9sZCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjbGVhciAoKSB7XG4gICAgICAgICAgICB2YXIgaG91c2Vob2xkID0ge307XG4gICAgICAgICAgICByZXR1cm4gaG91c2Vob2xkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLnNlcnZpY2UoJ1NlY3Rpb25zJywgc2VjdGlvbnNTZXJ2aWNlKTtcblxuICAgIHNlY3Rpb25zU2VydmljZS4kaW5qZWN0ID0gWyckc3RhdGUnXTtcblxuICAgIGZ1bmN0aW9uIHNlY3Rpb25zU2VydmljZSgkc3RhdGUpIHtcblxuICAgICAgICB2YXIgc2VjdGlvbnMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdDaGlsZHJlbicsXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdjaGlsZHJlbicsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0NoaWxkIEluY29tZScsXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdjaGlsZEluY29tZScsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0hvdXNlaG9sZCcsXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdob3VzZWhvbGQnLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdTaWduIGFuZCBDb25maXJtJyxcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ3NpZ25hdHVyZScsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgaW5kZXhlZFNlY3Rpb25zID0gXy5pbmRleEJ5KHNlY3Rpb25zLCAnc3RhdGUnKTtcblxuICAgICAgICAvLyBUT0RPOiBQdXQgc2tpcCBsb2dpYyBoZXJlXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpcmVkU2VjdGlvbnMoaG91c2Vob2xkKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudENoaWxkO1xuICAgICAgICAgICAgdmFyIGFzc2lzdGFuY2VQcm9ncmFtSG91c2Vob2xkID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgZm9zdGVyQ2hpbGRDb3VudCA9IDA7XG4gICAgICAgICAgICB2YXIgc2hvdWxkTWVhbnNUZXN0ID0gdHJ1ZTtcblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDAgOyBpIDwgaG91c2Vob2xkLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudENoaWxkID0gaG91c2Vob2xkLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDaGlsZC5hc3Npc3RhbmNlUHJvZ3JhbS5wYXJ0aWNpcGFudCkge1xuICAgICAgICAgICAgICAgICAgICBhc3Npc3RhbmNlUHJvZ3JhbUhvdXNlaG9sZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q2hpbGQuc3BlY2lhbFN0YXR1cy5mb3N0ZXJDaGlsZCkge1xuICAgICAgICAgICAgICAgICAgICBmb3N0ZXJDaGlsZENvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoYXNzaXN0YW5jZVByb2dyYW1Ib3VzZWhvbGQgfHxcbiAgICAgICAgICAgICAgICBob3VzZWhvbGQuY2hpbGRyZW4ubGVuZ3RoID09PSBmb3N0ZXJDaGlsZENvdW50KSB7XG4gICAgICAgICAgICAgICAgc2hvdWxkTWVhbnNUZXN0ID0gZmFsc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzaG91bGRNZWFuc1Rlc3QpIHtcbiAgICAgICAgICAgICAgICBzZWN0aW9ucy5mb3JFYWNoKGZ1bmN0aW9uKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgc2VjdGlvbi5yZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGluZGV4ZWRTZWN0aW9uc1snY2hpbGRJbmNvbWUnXS5yZXF1aXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGluZGV4ZWRTZWN0aW9uc1snaG91c2Vob2xkJ10ucmVxdWlyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZmluZE5leHQoY3VycmVudFN0YXRlKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudEluZGV4ID0gXy5maW5kSW5kZXgoc2VjdGlvbnMsIGZ1bmN0aW9uKHNlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gc2VjdGlvbi5zdGF0ZSA9PT0gY3VycmVudFN0YXRlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIExvb2sgZm9yIHRoZSBuZXh0IHJlcXVpcmVkIHNlY3Rpb25cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSBjdXJyZW50SW5kZXggKyAxOyBpIDwgc2VjdGlvbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBpZiAoc2VjdGlvbnNbaV0ucmVxdWlyZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlY3Rpb25zW2ldLnN0YXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gaWYgdGhlcmUgYXJlIG5vIG1vcmUgcmVxdWlyZWQgc2VjdGlvbnMsIHdlJ3JlIGRvbmUuXG4gICAgICAgICAgICByZXR1cm4gJ2NvbmZpcm1hdGlvbic7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBuYXZpZ2F0ZVRvTmV4dChjdXJyZW50U3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBuZXh0U2VjdGlvbiAgPSBmaW5kTmV4dChjdXJyZW50U3RhdGUpO1xuICAgICAgICAgICAgJHN0YXRlLmdvKG5leHRTZWN0aW9uKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBzZWN0aW9uczogc2VjdGlvbnMsXG4gICAgICAgICAgICBpbmRleGVkU2VjdGlvbnM6IGluZGV4ZWRTZWN0aW9ucyxcbiAgICAgICAgICAgIG5hdmlnYXRlVG9OZXh0OiBuYXZpZ2F0ZVRvTmV4dCxcbiAgICAgICAgICAgIHVwZGF0ZVJlcXVpcmVkU2VjdGlvbnM6IHVwZGF0ZVJlcXVpcmVkU2VjdGlvbnNcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcblxuICAgIH1cblxufSkoKTtcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
