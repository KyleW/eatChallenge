!function(){function e(e){}function t(e,t){function n(e,t){t.otherwise("/"),e.state("start",{url:"/",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/start.html",controller:"mainController"}}}).state("children",{url:"/children",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/children.html",controller:"mainController"}}}).state("childIncome",{url:"/childIncome",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/childIncome.html",controller:"mainController"}}}).state("household",{url:"/household",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/household.html",controller:"mainController"}}}).state("signature",{url:"/signature",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/signature.html",controller:"mainController"}}}).state("confirmation",{url:"/confirmation",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/confirmation.html",controller:"mainController"}}}).state("export",{url:"/export",templateUrl:"../views/export.html",controller:"mainController"}).state("styleguide",{url:"/styleguide",templateUrl:"../views/styleguide.html",controller:"mainController"}).state("signup",{url:"/signup",templateUrl:"../views/signup.html"}).state("login",{url:"/login",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/login.html",controller:"loginController"}}}).state("soFar",{url:"/so-far",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/soFar.html",controller:"mainController"}}})}n(e,t)}angular.module("eatChallengeApp",["ngMaterial","ui.router"]).config(t).config(e),e.$inject=["$mdThemingProvider"],t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(){console.log("running ok")}angular.module("eatChallengeApp").controller("loginController",[e])}(),function(){function e(e,t,n,o,r,i,l,s){function a(){l.save();s.updateRequiredSections(o.household);s.navigateToNext(i.$current.self.name)}o.schoolDistrict="Oakland Unified School District",o.studentStatuses=["in school","home schooled","some other status"],o.household=l.get(),o.navigateToNextSection=a,o.$watch("household.childCount",function(e){for(;e>o.household.children.length;)o.household.incrementChildCount()}),o.$watch("household.otherMembersCount",function(e){for(;e>o.household.otherMembers.length;)o.household.incrementOtherMembersCount()}),r.$on("$stateChangeSuccess",function(){document.body.scrollTop=document.documentElement.scrollTop=0}),r.$on("$stateChangeSuccess",function(e,t,n,o,r){s.previousState=o.name,s.currentState=t.name,console.log("Previous state:"+s.previousState),console.log("Current state:"+s.currentState)})}angular.module("eatChallengeApp").controller("mainController",e),e.$inject=["$interval","$mdDialog","$mdMedia","$rootScope","$scope","$state","Household","Sections"]}(),function(){function e(e,t,n){var o=e;o.currentState=t.$current.self.name,o.sections=n.sections}angular.module("eatChallengeApp").controller("sideNavController",e),e.$inject=["$scope","$state","Sections"]}(),function(){function e(){var e={scope:{member:"="},restrict:"A",replace:!0,templateUrl:"../views/income.html",link:t};return e}function t(e){e.incomeSources={work:{vaule:"work",label:"Earnings from work",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A child has a job where they earn salary or wages ",otherMember:""}},socialSecurity:{vaule:"socialSecurity",label:"Social Security Disability Payments or Survivorâ€™s Benefits ",frequency:["monthly"],annotation:{child:"A child is blind or disabled and receives Social Security benefits.",otherMember:""}},otherPerson:{vaule:"otherPerson",label:"Income from persons outside the household",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A friend or extended family member regularly gives a child spending money",otherMember:""}},otherSource:{vaule:"otherSource",label:"Income from any other source",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A child receives income from a private pension fund, annuity, or trust",otherMember:""}}},0===e.member.incomeSources.length&&(e.member.incomeSources=[],Object.keys(e.incomeSources).forEach(function(t){e.member.incomeSources.push({type:t,amount:null,frequency:null})}))}angular.module("eatChallengeApp").directive("incomeQuestions",e)}(),function(){function e(){return{scope:{model:"="},restrict:"A",replace:!0,templateUrl:"../views/yesno.html"}}angular.module("eatChallengeApp").directive("yesNoInput",e)}(),function(){function e(e){function t(){return r?r:(r=Object.create(l),r.init(),r)}function n(){return e.post("/household",r).then(function(e){r=e.data})}function o(){var e={};return e}this.get=t,this.save=n,this.clear=o;var r,i={init:function(){this.incomeSourceCount=0,this.incomeSources=[]},incrementIncomeSources:function(){for(this.incomeSourceCount++;this.incomeSourceCount>this.incomeSources.length;)this.incomeSources.push({})}},l={init:function(){this.children=[],this.childCount=0,this.incrementChildCount(),this.otherMembers=[],this.otherMembersCount=0,this.incrementOtherMembersCount()},incrementChildCount:function(){for(this.childCount++;this.childCount>this.children.length;){var e=Object.create(i);e.init(),e.isChild=!0,e.specialStatus={},e.assistanceProgram={},this.children.push(e)}},incrementOtherMembersCount:function(){for(this.otherMembersCount++;this.otherMembersCount>this.otherMembers.length;){var e=Object.create(i);e.init(),e.isChild=!1,this.otherMembers.push(e)}}};return this}angular.module("eatChallengeApp").service("Household",e),e.$inject=["$http"]}(),function(){function e(e){function t(e){for(var t,n=!1,o=0,l=!1,s=0;s<e.children.length;s++){if(t=e.children[s],t.assistanceProgram&&t.assistanceProgram.participant){n=!0;break}(t.specialStatus&&t.specialStatus.fosterChild||t.specialStatus.homelessMigrantRunaway||t.specialStatus.headStartParticipant)&&o++}return(l=n||e.children.length===o)?(i.childIncome.required=!1,void(i.household.required=!1)):void r.forEach(function(e){e.required=!0})}function n(e){for(var t=_.findIndex(r,function(t){return t.state===e}),n=t+1;n<r.length;n++)if(r[n].required)return r[n].state;return"confirmation"}function o(t){var o=n(t);e.go(o)}var r=[{label:"Children",state:"children",completed:!1,required:!0},{label:"Child Income",state:"childIncome",completed:!1,required:!0},{label:"Household",state:"household",completed:!1,required:!0},{label:"Sign and Confirm",state:"signature",completed:!1,required:!0}],i=_.indexBy(r,"state"),l={sections:r,indexedSections:i,navigateToNext:o,updateRequiredSections:t};return l}angular.module("eatChallengeApp").service("Sections",e),e.$inject=["$state"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL2xvZ2luLmpzIiwiY29udHJvbGxlcnMvbWFpbi5qcyIsImNvbnRyb2xsZXJzL3NpZGVuYXYuanMiLCJkaXJlY3RpdmVzL2luY29tZS5qcyIsImRpcmVjdGl2ZXMveWVzbm8uanMiLCJzZXJ2aWNlcy9ob3VzZWhvbGQuanMiLCJzZXJ2aWNlcy9zZWN0aW9ucy5qcyJdLCJuYW1lcyI6WyJtYXRlcmlhbERlc2lnblRoZW1lciIsIiRtZFRoZW1pbmdQcm92aWRlciIsInJvdXRlckNvbmZpZyIsIiRzdGF0ZVByb3ZpZGVyIiwiJHVybFJvdXRlclByb3ZpZGVyIiwicm91dGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsInNpZGUtbmF2IiwidGVtcGxhdGVVcmwiLCJjb250cm9sbGVyIiwibWFpbiIsImFuZ3VsYXIiLCJtb2R1bGUiLCJjb25maWciLCIkaW5qZWN0IiwibG9naW5Db250cm9sbGVyIiwiY29uc29sZSIsImxvZyIsIm1haW5Db250cm9sbGVyIiwiJGludGVydmFsIiwiJG1kRGlhbG9nIiwiJG1kTWVkaWEiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiSG91c2Vob2xkIiwiU2VjdGlvbnMiLCJuYXZpZ2F0ZVRvTmV4dFNlY3Rpb24iLCJzYXZlIiwidXBkYXRlUmVxdWlyZWRTZWN0aW9ucyIsImhvdXNlaG9sZCIsIm5hdmlnYXRlVG9OZXh0IiwiJGN1cnJlbnQiLCJzZWxmIiwibmFtZSIsInNjaG9vbERpc3RyaWN0Iiwic3R1ZGVudFN0YXR1c2VzIiwiZ2V0IiwiJHdhdGNoIiwibmV3VmFsIiwiY2hpbGRyZW4iLCJsZW5ndGgiLCJpbmNyZW1lbnRDaGlsZENvdW50Iiwib3RoZXJNZW1iZXJzIiwiaW5jcmVtZW50T3RoZXJNZW1iZXJzQ291bnQiLCIkb24iLCJkb2N1bWVudCIsImJvZHkiLCJzY3JvbGxUb3AiLCJkb2N1bWVudEVsZW1lbnQiLCJldiIsInRvIiwidG9QYXJhbXMiLCJmcm9tIiwiZnJvbVBhcmFtcyIsInByZXZpb3VzU3RhdGUiLCJjdXJyZW50U3RhdGUiLCJzaWRlTmF2Q29udHJvbGxlciIsInZtIiwic2VjdGlvbnMiLCJpbmNvbWVEaXJlY3RpdmUiLCJkaXJlY3RpdmUiLCJzY29wZSIsIm1lbWJlciIsInJlc3RyaWN0IiwicmVwbGFjZSIsImxpbmsiLCJpbmNvbWVTb3VyY2VzIiwid29yayIsInZhdWxlIiwibGFiZWwiLCJmcmVxdWVuY3kiLCJhbm5vdGF0aW9uIiwiY2hpbGQiLCJvdGhlck1lbWJlciIsInNvY2lhbFNlY3VyaXR5Iiwib3RoZXJQZXJzb24iLCJvdGhlclNvdXJjZSIsIk9iamVjdCIsImtleXMiLCJmb3JFYWNoIiwiaW5jb21lU291cmNlIiwicHVzaCIsInR5cGUiLCJhbW91bnQiLCJ5ZXNOb0lucHV0IiwibW9kZWwiLCJob3VzZWhvbGRTZXJ2aWNlIiwiJGh0dHAiLCJjcmVhdGUiLCJpbml0IiwicG9zdCIsInRoZW4iLCJyZXNwb25zZSIsImRhdGEiLCJjbGVhciIsInRoaXMiLCJQZXJzb24iLCJpbmNvbWVTb3VyY2VDb3VudCIsImluY3JlbWVudEluY29tZVNvdXJjZXMiLCJjaGlsZENvdW50Iiwib3RoZXJNZW1iZXJzQ291bnQiLCJuZXdDaGlsZCIsImlzQ2hpbGQiLCJzcGVjaWFsU3RhdHVzIiwiYXNzaXN0YW5jZVByb2dyYW0iLCJuZXdNZW1iZXIiLCJzZXJ2aWNlIiwic2VjdGlvbnNTZXJ2aWNlIiwiY3VycmVudENoaWxkIiwiYXNzaXN0YW5jZVByb2dyYW1Ib3VzZWhvbGQiLCJzcGVjaWFsU3RhdHVzQ291bnQiLCJza2lwTWVhbnNUZXN0IiwiaSIsInBhcnRpY2lwYW50IiwiZm9zdGVyQ2hpbGQiLCJob21lbGVzc01pZ3JhbnRSdW5hd2F5IiwiaGVhZFN0YXJ0UGFydGljaXBhbnQiLCJpbmRleGVkU2VjdGlvbnMiLCJyZXF1aXJlZCIsInNlY3Rpb24iLCJmaW5kTmV4dCIsImN1cnJlbnRJbmRleCIsIl8iLCJmaW5kSW5kZXgiLCJuZXh0U2Vj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QWxFLE1BQUEsV0FDQTJILFdBQUEsRUFDQVIsVUFBQSxJQUdBakQsTUFBQSxlQUNBbEUsTUFBQSxjQUNBMkgsV0FBQSxFQUNBUixVQUFBLElBR0FqRCxNQUFBLFlBQ0FsRSxNQUFBLFlBQ0EySCxXQUFBLEVBQ0FSLFVBQUEsSUFHQWpELE1BQUEsbUJBQ0FsRSxNQUFBLFlBQ0EySCxXQUFBLEVBQ0FSLFVBQUEsSUFJQUQsRUFBQUssRUFBQUssUUFBQXJFLEVBQUEsU0ErREFnRCxHQUNBaEQsU0FBQUEsRUFDQTJELGdCQUFBQSxFQUNBdkYsZUFBQUEsRUFDQUYsdUJBQUFBLEVBR0EsT0FBQThFLEdBekdBaEcsUUFDQUMsT0FBQSxtQkFDQStGLFFBQUEsV0FBQUMsR0FFQUEsRUFBQTlGLFNBQUEiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCkge1xuXG4gICAgYW5ndWxhclxuICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcsWyduZ01hdGVyaWFsJywndWkucm91dGVyJ10pXG4gICAgLmNvbmZpZyhyb3V0ZXJDb25maWcpXG4gICAgLmNvbmZpZyhtYXRlcmlhbERlc2lnblRoZW1lcik7XG5cbiAgICBtYXRlcmlhbERlc2lnblRoZW1lci4kaW5qZWN0ID0gWyckbWRUaGVtaW5nUHJvdmlkZXInXTtcbiAgICBmdW5jdGlvbiBtYXRlcmlhbERlc2lnblRoZW1lcigkbWRUaGVtaW5nUHJvdmlkZXIpIHtcbiAgICAgICAgLy8gJG1kVGhlbWluZ1Byb3ZpZGVyLnRoZW1lKCdsaWdodC1ibHVlJyk7XG4gICAgICAgIC8vIC5wcmltYXJ5UGFsZXR0ZSgncGluaycsIHtcbiAgICAgICAgLy8gICAnZGVmYXVsdCc6ICc0MDAnLCAvLyBieSBkZWZhdWx0IHVzZSBzaGFkZSA0MDAgZnJvbSB0aGUgcGluayBwYWxldHRlIGZvciBwcmltYXJ5IGludGVudGlvbnNcbiAgICAgICAgLy8gICAnaHVlLTEnOiAnMTAwJywgLy8gdXNlIHNoYWRlIDEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0xPC9jb2RlPiBjbGFzc1xuICAgICAgICAvLyAgICdodWUtMic6ICc2MDAnLCAvLyB1c2Ugc2hhZGUgNjAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTI8L2NvZGU+IGNsYXNzXG4gICAgICAgIC8vICAgJ2h1ZS0zJzogJ0ExMDAnIC8vIHVzZSBzaGFkZSBBMTAwIGZvciB0aGUgPGNvZGU+bWQtaHVlLTM8L2NvZGU+IGNsYXNzXG4gICAgICAgIC8vIH0pXG4gICAgICAgIC8vIC8vIElmIHlvdSBzcGVjaWZ5IGxlc3MgdGhhbiBhbGwgb2YgdGhlIGtleXMsIGl0IHdpbGwgaW5oZXJpdCBmcm9tIHRoZVxuICAgICAgICAvLyAvLyBkZWZhdWx0IHNoYWRlc1xuICAgICAgICAvLyAuYWNjZW50UGFsZXR0ZSgncHVycGxlJywge1xuICAgICAgICAvLyAgICdkZWZhdWx0JzogJzIwMCcgLy8gdXNlIHNoYWRlIDIwMCBmb3IgZGVmYXVsdCwgYW5kIGtlZXAgYWxsIG90aGVyIHNoYWRlcyB0aGUgc2FtZVxuICAgICAgICAvLyB9KTtcbiAgICB9XG5cbiAgICByb3V0ZXJDb25maWcuJGluamVjdCA9IFsnJHN0YXRlUHJvdmlkZXInLCAnJHVybFJvdXRlclByb3ZpZGVyJ107XG5cbiAgICBmdW5jdGlvbiByb3V0ZXJDb25maWcgKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuICAgICAgICByb3V0ZXIoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcik7XG5cbiAgICAgICAgLy8vLy8vLy8vL1xuICAgICAgICBmdW5jdGlvbiByb3V0ZXIoJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlcikge1xuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG4gICAgICAgICAgICAkc3RhdGVQcm92aWRlclxuICAgICAgICAgICAgLnN0YXRlKCdzdGFydCcsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lkZU5hdi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3N0YXJ0Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21haW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY2hpbGRyZW4nLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NoaWxkcmVuJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgJ3NpZGUtbmF2Jzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2NoaWxkcmVuLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY2hpbGRJbmNvbWUnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnL2NoaWxkSW5jb21lJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MvY2hpbGRJbmNvbWUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnaG91c2Vob2xkJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9ob3VzZWhvbGQnLFxuICAgICAgICAgICAgICAgIHZpZXdzOntcbiAgICAgICAgICAgICAgICAgICAgJ3NpZGUtbmF2Jzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnbWFpbic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9ob3VzZWhvbGQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnc2lnbmF0dXJlJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9zaWduYXR1cmUnLFxuICAgICAgICAgICAgICAgIHZpZXdzOntcbiAgICAgICAgICAgICAgICAgICAgJ3NpZGUtbmF2Jzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnbWFpbic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWduYXR1cmUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnY29uZmlybWF0aW9uJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9jb25maXJtYXRpb24nLFxuICAgICAgICAgICAgICAgIHZpZXdzOntcbiAgICAgICAgICAgICAgICAgICAgJ3NpZGUtbmF2Jzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnbWFpbic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9jb25maXJtYXRpb24uaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5zdGF0ZSgnZXhwb3J0Jywge1xuICAgICAgICAgICAgICB1cmw6ICcvZXhwb3J0JyxcbiAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9leHBvcnQuaHRtbCcsXG4gICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdzdHlsZWd1aWRlJywge1xuICAgICAgICAgICAgICB1cmw6ICcvc3R5bGVndWlkZScsXG4gICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc3R5bGVndWlkZS5odG1sJyxcbiAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21haW5Db250cm9sbGVyJ1xuICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ3NpZ251cCcsIHtcbiAgICAgICAgICAgICAgdXJsOiAnL3NpZ251cCcsXG4gICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lnbnVwLmh0bWwnLFxuICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICAgICAgICAgIHVybDogJy9sb2dpbicsXG4gICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lkZU5hdi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3NpZGVOYXZDb250cm9sbGVyJ1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2xvZ2luLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbG9naW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLnN0YXRlKCdzb0ZhcicsIHtcbiAgICAgICAgICAgICAgICB1cmw6ICcvc28tZmFyJyxcbiAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc29GYXIuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnKVxuICAgICAgLmNvbnRyb2xsZXIoJ2xvZ2luQ29udHJvbGxlcicsIFtsb2dpbkNvbnRyb2xsZXJdKTtcblxuICAgIGZ1bmN0aW9uIGxvZ2luQ29udHJvbGxlcigpIHtcbiAgICAgICAgdmFyIGxvZ2luVk0gPSB0aGlzO1xuICAgICAgICBjb25zb2xlLmxvZygncnVubmluZyBvaycpO1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ21haW5Db250cm9sbGVyJywgbWFpbkNvbnRyb2xsZXIpO1xuXG4gICAgbWFpbkNvbnRyb2xsZXIuJGluamVjdCA9IFsnJGludGVydmFsJywgJyRtZERpYWxvZycsICckbWRNZWRpYScsICckcm9vdFNjb3BlJywgJyRzY29wZScsICckc3RhdGUnLCAnSG91c2Vob2xkJywgJ1NlY3Rpb25zJ107XG5cbiAgICBmdW5jdGlvbiBtYWluQ29udHJvbGxlciAoJGludGVydmFsLCAkbWREaWFsb2csICRtZE1lZGlhLCAkc2NvcGUsICRyb290U2NvcGUsICRzdGF0ZSwgSG91c2Vob2xkLCBTZWN0aW9ucykge1xuICAgICAgICAvLyBUT0RPOiByZXBsYWNlIHNjb3BlIHdpdGggdm1cbiAgICAgICAgJHNjb3BlLnNjaG9vbERpc3RyaWN0ID0gJ09ha2xhbmQgVW5pZmllZCBTY2hvb2wgRGlzdHJpY3QnO1xuICAgICAgICAkc2NvcGUuc3R1ZGVudFN0YXR1c2VzID0gWydpbiBzY2hvb2wnLCAnaG9tZSBzY2hvb2xlZCcsICdzb21lIG90aGVyIHN0YXR1cyddO1xuXG4gICAgICAgICRzY29wZS5ob3VzZWhvbGQgPSBIb3VzZWhvbGQuZ2V0KCk7XG4gICAgICAgICRzY29wZS5uYXZpZ2F0ZVRvTmV4dFNlY3Rpb24gPSBuYXZpZ2F0ZVRvTmV4dFNlY3Rpb247XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2hvdXNlaG9sZC5jaGlsZENvdW50JywgZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICB3aGlsZSAobmV3VmFsID4gJHNjb3BlLmhvdXNlaG9sZC5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAkc2NvcGUuaG91c2Vob2xkLmluY3JlbWVudENoaWxkQ291bnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgnaG91c2Vob2xkLm90aGVyTWVtYmVyc0NvdW50JywgZnVuY3Rpb24obmV3VmFsKSB7XG4gICAgICAgICAgICB3aGlsZSAobmV3VmFsID4gJHNjb3BlLmhvdXNlaG9sZC5vdGhlck1lbWJlcnMubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhvdXNlaG9sZC5pbmNyZW1lbnRPdGhlck1lbWJlcnNDb3VudCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUT0RPOiBtb3ZlIHRoaXMgdG8gY29uZmlnIG9yIHNvbWV0aGluZ1xuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wID0gMDtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gJHJvb3RTY29wZS5wcmV2aW91c1N0YXRlO1xuICAgICAgICAvLyAkcm9vdFNjb3BlLmN1cnJlbnRTdGF0ZTtcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbihldiwgdG8sIHRvUGFyYW1zLCBmcm9tLCBmcm9tUGFyYW1zKSB7XG4gICAgICAgICAgICBTZWN0aW9ucy5wcmV2aW91c1N0YXRlID0gZnJvbS5uYW1lO1xuICAgICAgICAgICAgU2VjdGlvbnMuY3VycmVudFN0YXRlID0gdG8ubmFtZTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdQcmV2aW91cyBzdGF0ZTonICsgU2VjdGlvbnMucHJldmlvdXNTdGF0ZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ3VycmVudCBzdGF0ZTonICsgU2VjdGlvbnMuY3VycmVudFN0YXRlKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgZnVuY3Rpb24gbmF2aWdhdGVUb05leHRTZWN0aW9uKCkge1xuICAgICAgICAgICAgSG91c2Vob2xkLnNhdmUoKTtcbiAgICAgICAgICAgIHZhciB1cGRhdGVkID0gU2VjdGlvbnMudXBkYXRlUmVxdWlyZWRTZWN0aW9ucygkc2NvcGUuaG91c2Vob2xkKTtcbiAgICAgICAgICAgIFNlY3Rpb25zLm5hdmlnYXRlVG9OZXh0KCRzdGF0ZS4kY3VycmVudC5zZWxmLm5hbWUpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdzaWRlTmF2Q29udHJvbGxlcicsIHNpZGVOYXZDb250cm9sbGVyKTtcblxuICAgIHNpZGVOYXZDb250cm9sbGVyLiRpbmplY3QgPSBbJyRzY29wZScsICckc3RhdGUnLCAnU2VjdGlvbnMnXTtcblxuICAgIGZ1bmN0aW9uIHNpZGVOYXZDb250cm9sbGVyICgkc2NvcGUsICRzdGF0ZSwgU2VjdGlvbnMpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgICAgICB2YXIgdm0gPSAkc2NvcGU7XG5cbiAgICAgICAgdm0uY3VycmVudFN0YXRlID0gJHN0YXRlLiRjdXJyZW50LnNlbGYubmFtZTtcbiAgICAgICAgdm0uc2VjdGlvbnMgPSBTZWN0aW9ucy5zZWN0aW9ucztcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ2luY29tZVF1ZXN0aW9ucycsIGluY29tZURpcmVjdGl2ZSk7XG5cbiAgICBmdW5jdGlvbiBpbmNvbWVEaXJlY3RpdmUoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICBzY29wZToge1xuICAgICAgICAgICAgICAgIG1lbWJlcjogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2luY29tZS5odG1sJyxcbiAgICAgICAgICAgIGxpbms6IGxpbmtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgIH1cblxuICAgIC8vIGxpbmsuJGluamVjdCA9IFsnc2NvcGUnXTtcblxuICAgIGZ1bmN0aW9uIGxpbmsoc2NvcGUpIHtcbiAgICAgICAgc2NvcGUuaW5jb21lU291cmNlcyA9IHtcbiAgICAgICAgICAgIHdvcms6IHtcbiAgICAgICAgICAgICAgICB2YXVsZTond29yaycsXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdFYXJuaW5ncyBmcm9tIHdvcmsnLFxuICAgICAgICAgICAgICAgIGZyZXF1ZW5jeTogWyd3ZWVrbHknLCAnYml3ZWVrbHknLCAnMnggbW9udGgnLCAnbW9udGhseSddLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQ6ICdBIGNoaWxkIGhhcyBhIGpvYiB3aGVyZSB0aGV5IGVhcm4gc2FsYXJ5IG9yIHdhZ2VzICcsXG4gICAgICAgICAgICAgICAgICAgIG90aGVyTWVtYmVyOiAnJyxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgc29jaWFsU2VjdXJpdHk6IHtcbiAgICAgICAgICAgICAgICB2YXVsZTonc29jaWFsU2VjdXJpdHknLFxuICAgICAgICAgICAgICAgIGxhYmVsOiAnU29jaWFsIFNlY3VyaXR5IERpc2FiaWxpdHkgUGF5bWVudHMgb3IgU3Vydml2b3LigJlzIEJlbmVmaXRzICcsXG4gICAgICAgICAgICAgICAgZnJlcXVlbmN5OiBbJ21vbnRobHknXSxcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkOiAnQSBjaGlsZCBpcyBibGluZCBvciBkaXNhYmxlZCBhbmQgcmVjZWl2ZXMgU29jaWFsIFNlY3VyaXR5IGJlbmVmaXRzLicsXG4gICAgICAgICAgICAgICAgICAgIC8vICcgQSBwYXJlbnQgaXMgZGlzYWJsZWQsIHJldGlyZWQsIG9yIGRlY2Vhc2VkLCBhbmQgdGhlaXIgY2hpbGQgcmVjZWl2ZXMgc29jaWFsIHNlY3VyaXR5IGJlbmVmaXRzJyxcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJNZW1iZXI6ICcnLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvdGhlclBlcnNvbjoge1xuICAgICAgICAgICAgICAgIHZhdWxlOidvdGhlclBlcnNvbicsXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdJbmNvbWUgZnJvbSBwZXJzb25zIG91dHNpZGUgdGhlIGhvdXNlaG9sZCcsXG4gICAgICAgICAgICAgICAgZnJlcXVlbmN5OiBbJ3dlZWtseScsICdiaXdlZWtseScsICcyeCBtb250aCcsICdtb250aGx5J10sXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZDogJ0EgZnJpZW5kIG9yIGV4dGVuZGVkIGZhbWlseSBtZW1iZXIgcmVndWxhcmx5IGdpdmVzIGEgY2hpbGQgc3BlbmRpbmcgbW9uZXknLFxuICAgICAgICAgICAgICAgICAgICBvdGhlck1lbWJlcjogJycsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG90aGVyU291cmNlOiB7XG4gICAgICAgICAgICAgICAgdmF1bGU6J290aGVyU291cmNlJyxcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0luY29tZSBmcm9tIGFueSBvdGhlciBzb3VyY2UnLFxuICAgICAgICAgICAgICAgIGZyZXF1ZW5jeTogWyd3ZWVrbHknLCAnYml3ZWVrbHknLCAnMnggbW9udGgnLCAnbW9udGhseSddLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQ6ICdBIGNoaWxkIHJlY2VpdmVzIGluY29tZSBmcm9tIGEgcHJpdmF0ZSBwZW5zaW9uIGZ1bmQsIGFubnVpdHksIG9yIHRydXN0JyxcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJNZW1iZXI6ICcnLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICBpZiAoc2NvcGUubWVtYmVyLmluY29tZVNvdXJjZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBzY29wZS5tZW1iZXIuaW5jb21lU291cmNlcyA9IFtdO1xuICAgICAgICAgICAgT2JqZWN0LmtleXMoc2NvcGUuaW5jb21lU291cmNlcykuZm9yRWFjaChmdW5jdGlvbihpbmNvbWVTb3VyY2UpIHtcbiAgICAgICAgICAgICAgICBzY29wZS5tZW1iZXIuaW5jb21lU291cmNlcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogaW5jb21lU291cmNlLFxuICAgICAgICAgICAgICAgICAgICBhbW91bnQ6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgIGZyZXF1ZW5jeTogbnVsbFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3llc05vSW5wdXQnLCB5ZXNOb0lucHV0KTtcblxuICAgIGZ1bmN0aW9uIHllc05vSW5wdXQgKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBtb2RlbDogJz0nXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3llc25vLmh0bWwnLFxuICAgICAgICB9O1xuICAgIH1cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcpXG4gICAgICAgIC5zZXJ2aWNlKCdIb3VzZWhvbGQnLCBob3VzZWhvbGRTZXJ2aWNlKTtcblxuICAgIGhvdXNlaG9sZFNlcnZpY2UuJGluamVjdCA9IFsnJGh0dHAnXTtcblxuICAgIGZ1bmN0aW9uIGhvdXNlaG9sZFNlcnZpY2UoJGh0dHApIHtcbiAgICAgICAgdGhpcy5nZXQgPSBnZXQ7XG4gICAgICAgIHRoaXMuc2F2ZSA9IHNhdmU7XG4gICAgICAgIHRoaXMuY2xlYXIgPSBjbGVhcjtcblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgdmFyIFBlcnNvbiA9IHtcbiAgICAgICAgICAgIGluaXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5jb21lU291cmNlQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5jb21lU291cmNlcyA9IFtdO1xuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgaW5jcmVtZW50SW5jb21lU291cmNlczogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmNvbWVTb3VyY2VDb3VudCsrO1xuICAgICAgICAgICAgICAgIHdoaWxlICh0aGlzLmluY29tZVNvdXJjZUNvdW50ID4gdGhpcy5pbmNvbWVTb3VyY2VzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmluY29tZVNvdXJjZXMucHVzaCh7fSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBIb3VzZWhvbGQgPSB7XG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRDb3VudCA9IDA7XG4gICAgICAgICAgICAgICAgdGhpcy5pbmNyZW1lbnRDaGlsZENvdW50KCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyTWVtYmVycyA9IFtdO1xuICAgICAgICAgICAgICAgIHRoaXMub3RoZXJNZW1iZXJzQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5jcmVtZW50T3RoZXJNZW1iZXJzQ291bnQoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBpbmNyZW1lbnRDaGlsZENvdW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkQ291bnQrKztcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5jaGlsZENvdW50ID4gdGhpcy5jaGlsZHJlbi5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld0NoaWxkID0gT2JqZWN0LmNyZWF0ZShQZXJzb24pO1xuICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZC5pbml0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy9hZGQgY2hpbGQgc3BlY2lmaWMgZmllbGRzXG4gICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkLmlzQ2hpbGQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZC5zcGVjaWFsU3RhdHVzID0ge307XG4gICAgICAgICAgICAgICAgICAgIG5ld0NoaWxkLmFzc2lzdGFuY2VQcm9ncmFtID0ge307XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jaGlsZHJlbi5wdXNoKG5ld0NoaWxkKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jcmVtZW50T3RoZXJNZW1iZXJzQ291bnQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMub3RoZXJNZW1iZXJzQ291bnQrKztcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5vdGhlck1lbWJlcnNDb3VudCA+IHRoaXMub3RoZXJNZW1iZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgbmV3TWVtYmVyID0gT2JqZWN0LmNyZWF0ZShQZXJzb24pO1xuICAgICAgICAgICAgICAgICAgICBuZXdNZW1iZXIuaW5pdCgpO1xuICAgICAgICAgICAgICAgICAgICBuZXdNZW1iZXIuaXNDaGlsZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm90aGVyTWVtYmVycy5wdXNoKG5ld01lbWJlcik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGhvdXNlaG9sZDtcblxuICAgICAgICBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICAgICAgICBpZiAoaG91c2Vob2xkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhvdXNlaG9sZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9UT0RPOiBpZiB0aGVyZSdzIGEgdXNlcmlkLCByZXR1cm4gdGhlIGhvdXNlaG9sZCBhc3NvY2lhdGVkIHdpdGggaXRcbiAgICAgICAgICAgIC8vIGlmICh1c2VyaWQpIHtcbiAgICAgICAgICAgIC8vICAgICAvLyBUT0RPOiBhZGQgZXJyb3IgaGFuZGxpbmdcbiAgICAgICAgICAgIC8vICAgICAkaHR0cC5nZXQoJy9ob3VzZWhvbGQnKS50aGVuKGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAgICAgICAgIC8vICAgICAgICAgcmV0dXJuIGhvdXNlaG9sZCA9IGRhdGE7XG4gICAgICAgICAgICAvLyAgICAgfSk7XG4gICAgICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gICAgIC8vIGNyZWF0ZSBhIG5ldyBob3VzZWhvbGQgaWYgb25lIGRvZXNuJ3QgZXhpc3RcbiAgICAgICAgICAgIGhvdXNlaG9sZCA9IE9iamVjdC5jcmVhdGUoSG91c2Vob2xkKTtcbiAgICAgICAgICAgIGhvdXNlaG9sZC5pbml0KCk7XG4gICAgICAgICAgICAvLyB9XG5cbiAgICAgICAgICAgIHJldHVybiBob3VzZWhvbGQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzYXZlKCkge1xuICAgICAgICAgICAgLy8gVE9ETzogaGFuZGxlIGVycm9yc1xuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJy9ob3VzZWhvbGQnLCBob3VzZWhvbGQpLnRoZW4oZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBob3VzZWhvbGQgPSByZXNwb25zZS5kYXRhO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjbGVhciAoKSB7XG4gICAgICAgICAgICB2YXIgaG91c2Vob2xkID0ge307XG4gICAgICAgICAgICByZXR1cm4gaG91c2Vob2xkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnZWF0Q2hhbGxlbmdlQXBwJylcbiAgICAgICAgLnNlcnZpY2UoJ1NlY3Rpb25zJywgc2VjdGlvbnNTZXJ2aWNlKTtcblxuICAgIHNlY3Rpb25zU2VydmljZS4kaW5qZWN0ID0gWyckc3RhdGUnXTtcblxuICAgIGZ1bmN0aW9uIHNlY3Rpb25zU2VydmljZSgkc3RhdGUpIHtcblxuICAgICAgICB2YXIgc2VjdGlvbnMgPSBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdDaGlsZHJlbicsXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdjaGlsZHJlbicsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0NoaWxkIEluY29tZScsXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdjaGlsZEluY29tZScsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0hvdXNlaG9sZCcsXG4gICAgICAgICAgICAgICAgc3RhdGU6ICdob3VzZWhvbGQnLFxuICAgICAgICAgICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWVcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbGFiZWw6ICdTaWduIGFuZCBDb25maXJtJyxcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ3NpZ25hdHVyZScsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgXTtcblxuICAgICAgICB2YXIgaW5kZXhlZFNlY3Rpb25zID0gXy5pbmRleEJ5KHNlY3Rpb25zLCAnc3RhdGUnKTtcblxuICAgICAgICAvLyBUT0RPOiBQdXQgc2tpcCBsb2dpYyBoZXJlXG4gICAgICAgIGZ1bmN0aW9uIHVwZGF0ZVJlcXVpcmVkU2VjdGlvbnMoaG91c2Vob2xkKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudENoaWxkO1xuICAgICAgICAgICAgdmFyIGFzc2lzdGFuY2VQcm9ncmFtSG91c2Vob2xkID0gZmFsc2U7XG4gICAgICAgICAgICB2YXIgc3BlY2lhbFN0YXR1c0NvdW50ID0gMDtcbiAgICAgICAgICAgIHZhciBza2lwTWVhbnNUZXN0ID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwIDsgaSA8IGhvdXNlaG9sZC5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRDaGlsZCA9IGhvdXNlaG9sZC5jaGlsZHJlbltpXTtcblxuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50Q2hpbGQuYXNzaXN0YW5jZVByb2dyYW0gJiYgY3VycmVudENoaWxkLmFzc2lzdGFuY2VQcm9ncmFtLnBhcnRpY2lwYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2lzdGFuY2VQcm9ncmFtSG91c2Vob2xkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDaGlsZC5zcGVjaWFsU3RhdHVzICYmIGN1cnJlbnRDaGlsZC5zcGVjaWFsU3RhdHVzLmZvc3RlckNoaWxkIHx8XG4gICAgICAgICAgICAgICAgICAgIGN1cnJlbnRDaGlsZC5zcGVjaWFsU3RhdHVzLmhvbWVsZXNzTWlncmFudFJ1bmF3YXkgfHxcbiAgICAgICAgICAgICAgICAgICAgY3VycmVudENoaWxkLnNwZWNpYWxTdGF0dXMuaGVhZFN0YXJ0UGFydGljaXBhbnRcbiAgICAgICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICAgICAgc3BlY2lhbFN0YXR1c0NvdW50Kys7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBza2lwTWVhbnNUZXN0ID0gYXNzaXN0YW5jZVByb2dyYW1Ib3VzZWhvbGQgfHxcbiAgICAgICAgICAgICAgICAoaG91c2Vob2xkLmNoaWxkcmVuLmxlbmd0aCA9PT0gc3BlY2lhbFN0YXR1c0NvdW50KTtcblxuICAgICAgICAgICAgaWYgKHNraXBNZWFuc1Rlc3QpIHtcbiAgICAgICAgICAgICAgICBpbmRleGVkU2VjdGlvbnNbJ2NoaWxkSW5jb21lJ10ucmVxdWlyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICBpbmRleGVkU2VjdGlvbnNbJ2hvdXNlaG9sZCddLnJlcXVpcmVkID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24oc2VjdGlvbikge1xuICAgICAgICAgICAgICAgIHNlY3Rpb24ucmVxdWlyZWQgPSB0cnVlO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGZpbmROZXh0KGN1cnJlbnRTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRJbmRleCA9IF8uZmluZEluZGV4KHNlY3Rpb25zLCBmdW5jdGlvbihzZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHNlY3Rpb24uc3RhdGUgPT09IGN1cnJlbnRTdGF0ZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBMb29rIGZvciB0aGUgbmV4dCByZXF1aXJlZCBzZWN0aW9uXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gY3VycmVudEluZGV4ICsgMTsgaSA8IHNlY3Rpb25zLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgaWYgKHNlY3Rpb25zW2ldLnJlcXVpcmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBzZWN0aW9uc1tpXS5zdGF0ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIGlmIHRoZXJlIGFyZSBubyBtb3JlIHJlcXVpcmVkIHNlY3Rpb25zLCB3ZSdyZSBkb25lLlxuICAgICAgICAgICAgcmV0dXJuICdjb25maXJtYXRpb24nO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbmF2aWdhdGVUb05leHQoY3VycmVudFN0YXRlKSB7XG4gICAgICAgICAgICB2YXIgbmV4dFNlY3Rpb24gID0gZmluZE5leHQoY3VycmVudFN0YXRlKTtcbiAgICAgICAgICAgICRzdGF0ZS5nbyhuZXh0U2VjdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgc2VjdGlvbnM6IHNlY3Rpb25zLFxuICAgICAgICAgICAgaW5kZXhlZFNlY3Rpb25zOiBpbmRleGVkU2VjdGlvbnMsXG4gICAgICAgICAgICBuYXZpZ2F0ZVRvTmV4dDogbmF2aWdhdGVUb05leHQsXG4gICAgICAgICAgICB1cGRhdGVSZXF1aXJlZFNlY3Rpb25zOiB1cGRhdGVSZXF1aXJlZFNlY3Rpb25zXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICB9XG5cbn0pKCk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
