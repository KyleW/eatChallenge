!function(){function e(e){}function t(e,t){function n(e,t){t.otherwise("/"),e.state("start",{url:"/",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/start.html",controller:"mainController"}}}).state("children",{url:"/children",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/children.html",controller:"mainController"}}}).state("childIncome",{url:"/childIncome",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/childIncome.html",controller:"mainController"}}}).state("household",{url:"/household",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/household.html",controller:"mainController"}}}).state("signature",{url:"/signature",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/signature.html",controller:"mainController"}}}).state("confirmation",{url:"/confirmation",views:{"side-nav":{templateUrl:"../views/sideNav.html",controller:"sideNavController"},main:{templateUrl:"../views/confirmation.html",controller:"mainController"}}}).state("export",{url:"/export",templateUrl:"../views/export.html",controller:"mainController"}).state("styleguide",{url:"/styleguide",templateUrl:"../views/styleguide.html",controller:"mainController"}).state("signup",{url:"/signup",templateUrl:"../views/signup.html"}).state("login",{url:"/login",templateUrl:"../views/login.html"})}n(e,t)}angular.module("eatChallengeApp",["ngMaterial","ui.router"]).config(t).config(e),e.$inject=["$mdThemingProvider"],t.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(e,t,n,o,r,i,l,s){function a(){s.updateRequiredSections(o.household),s.navigateToNext(i.$current.self.name)}o.schoolDistrict="Oakland Unified School District",o.studentStatuses=["in school","home schooled","some other status"],o.household=l.get(),o.navigateToNextSection=a,o.$watch("household.childCount",function(e){for(;e>o.household.children.length;)o.household.incrementChildCount()}),o.$watch("household.otherMembersCount",function(e){for(;e>o.household.otherMembers.length;)o.household.incrementOtherMembersCount()}),r.$on("$stateChangeSuccess",function(){document.body.scrollTop=document.documentElement.scrollTop=0})}angular.module("eatChallengeApp").controller("mainController",e),e.$inject=["$interval","$mdDialog","$mdMedia","$rootScope","$scope","$state","Household","Sections"]}(),function(){function e(e,t,n){var o=e;o.currentState=t.$current.self.name,o.sections=n.sections}angular.module("eatChallengeApp").controller("sideNavController",e),e.$inject=["$scope","$state","Sections"]}(),function(){function e(){var e={scope:{member:"="},restrict:"A",replace:!0,templateUrl:"../views/income.html",link:t};return e}function t(e){e.incomeSources={work:{vaule:"work",label:"Earnings from work",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A child has a job where they earn salary or wages ",otherMember:""}},socialSecurity:{vaule:"socialSecurity",label:"Social Security Disability Payments or Survivorâ€™s Benefits ",frequency:["monthly"],annotation:{child:"A child is blind or disabled and receives Social Security benefits.",otherMember:""}},otherPerson:{vaule:"otherPerson",label:"Income from persons outside the household",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A friend or extended family member regularly gives a child spending money",otherMember:""}},otherSource:{vaule:"otherSource",label:"Income from any other source",frequency:["weekly","biweekly","2x month","monthly"],annotation:{child:"A child receives income from a private pension fund, annuity, or trust",otherMember:""}}},0===e.member.incomeSources.length&&(e.member.incomeSources=[],Object.keys(e.incomeSources).forEach(function(t){e.member.incomeSources.push({type:t,amount:null,frequency:null})}))}angular.module("eatChallengeApp").directive("incomeQuestions",e)}(),function(){function e(){return{scope:{model:"="},restrict:"A",replace:!0,templateUrl:"../views/yesno.html"}}angular.module("eatChallengeApp").directive("yesNoInput",e)}(),function(){function e(e){function t(){return r?r:(r=Object.create(l),r.init(),r)}function n(){return e.post("/household",r)}function o(){var e={};return e}this.get=t,this.save=n,this.clear=o;var r,i={init:function(){this.incomeSourceCount=0,this.incomeSources=[]},incrementIncomeSources:function(){for(this.incomeSourceCount++;this.incomeSourceCount>this.incomeSources.length;)this.incomeSources.push({})}},l={init:function(){this.children=[],this.childCount=0,this.incrementChildCount(),this.otherMembers=[],this.otherMembersCount=0,this.incrementOtherMembersCount()},incrementChildCount:function(){for(this.childCount++;this.childCount>this.children.length;){var e=Object.create(i);e.init(),e.isChild=!0,e.specialStatus={},e.assistanceProgram={},this.children.push(e)}},incrementOtherMembersCount:function(){for(this.otherMembersCount++;this.otherMembersCount>this.otherMembers.length;){var e=Object.create(i);e.init(),e.isChild=!1,this.otherMembers.push(e)}}};return this}angular.module("eatChallengeApp").service("Household",e),e.$inject=["$http"]}(),function(){function e(e){function t(e){for(var t,n=!1,o=0,l=!0,s=0;s<e.children.length;s++){if(t=e.children[s],t.assistanceProgram.participant){n=!0;break}t.specialStatus.fosterChild&&o++}(n||e.children.length===o)&&(l=!1),console.log({shouldMeansTest:l}),l?r.forEach(function(e){e.required=!0}):(i.childIncome.required=!1,i.household.required=!1)}function n(e){for(var t=_.findIndex(r,function(t){return t.state===e}),n=t+1;n<r.length;n++)if(r[n].required)return r[n].state;return"confirmation"}function o(t){var o=n(t);e.go(o)}var r=[{label:"Children",state:"children",completed:!1,required:!0},{label:"Child Income",state:"childIncome",completed:!1,required:!0},{label:"Household",state:"household",completed:!1,required:!0},{label:"Sign and Confirm",state:"signature",completed:!1,required:!0}],i=_.indexBy(r,"state"),l={sections:r,indexedSections:i,navigateToNext:o,updateRequiredSections:t};return l}angular.module("eatChallengeApp").service("Sections",e),e.$inject=["$state"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImNvbnRyb2xsZXJzL21haW4uanMiLCJjb250cm9sbGVycy9zaWRlbmF2LmpzIiwiZGlyZWN0aXZlcy9pbmNvbWUuanMiLCJkaXJlY3RpdmVzL3llc25vLmpzIiwic2VydmljZXMvaG91c2Vob2xkLmpzIiwic2VydmljZXMvc2VjdGlvbnMuanMiXSwibmFtZXMiOlsibWF0ZXJpYWxEZXNpZ25UaGVtZXIiLCIkbWRUaGVtaW5nUHJvdmlkZXIiLCJyb3V0ZXJDb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsInJvdXRlciIsIm90aGVyd2lzZSIsInN0YXRlIiwidXJsIiwidmlld3MiLCJzaWRlLW5hdiIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsIm1haW4iLCJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJGluamVjdCIsIm1haW5Db250cm9sbGVyIiwiJGludGVydmFsIiwiJG1kRGlhbG9nIiwiJG1kTWVkaWEiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiJHN0YXRlIiwiSG91c2Vob2xkIiwiU2VjdGlvbnMiLCJuYXZpZ2F0ZVRvTmV4dFNlY3Rpb24iLCJ1cGRhdGVSZXF1aXJlZFNlY3Rpb25zIiwiaG91c2Vob2xkIiwibmF2aWdhdGVUb05leHQiLCIkY3VycmVudCIsInNlbGYiLCJuYW1lIiwic2Nob29sRGlzdHJpY3QiLCJzdHVkZW50U3RhdHVzZXMiLCJnZXQiLCIkd2F0Y2giLCJuZXdWYWwiLCJjaGlsZHJlbiIsImxlbmd0aCIsImluY3JlbWVudENoaWxkQ291bnQiLCJvdGhlck1lbWJlcnMiLCJpbmNyZW1lbnRPdGhlck1lbWJlcnNDb3VudCIsIiRvbiIsImRvY3VtZW50IiwiYm9keSIsInNjcm9sbFRvcCIsImRvY3VtZW50RWxlbWVudCIsInNpZGVOYXZDb250cm9sbGVyIiwidm0iLCJjdXJyZW50U3RhdGUiLCJzZWN0aW9ucyIsImluY29tZURpcmVjdGl2ZSIsImRpcmVjdGl2ZSIsInNjb3BlIiwibWVtYmVyIiwicmVzdHJpY3QiLCJyZXBsYWNlIiwibGluayIsImluY29tZVNvdXJjZXMiLCJ3b3JrIiwidmF1bGUiLCJsYWJlbCIsImZyZXF1ZW5jeSIsImFubm90YXRpb24iLCJjaGlsZCIsIm90aGVyTWVtYmVyIiwic29jaWFsU2VjdXJpdHkiLCJvdGhlclBlcnNvbiIsIm90aGVyU291cmNlIiwiT2JqZWN0Iiwia2V5cyIsImZvckVhY2giLCJpbmNvbWVTb3VyY2UiLCJwdXNoIiwidHlwZSIsImFtb3VudCIsInllc05vSW5wdXQiLCJtb2RlbCIsImhvdXNlaG9sZFNlcnZpY2UiLCIkaHR0cCIsImNyZWF0ZSIsImluaXQiLCJzYXZlIiwicG9zdCIsImNsZWFyIiwidGhpcyIsIlBlcnNvbiIsImluY29tZVNvdXJjZUNvdW50IiwiaW5jcmVtZW50SW5jb21lU291cmNlcyIsImNoaWxkQ291bnQiLCJvdGhlck1lbWJlcnNDb3VudCIsIm5ld0NoaWxkIiwiaXNDaGlsZCIsInNwZWNpYWxTdGF0dXMiLCJhc3Npc3RhbmNlUHJvZ3JhbSIsIm5ld01lbWJlciIsInNlcnZpY2UiLCJzZWN0aW9uc1NlcnZpY2UiLCJjdXJyZW50Q2hpbGQiLCJhc3Npc3RhbmNlUHJvZ3JhbUhvdXNlaG9sZCIsImZvc3RlckNoaWxkQ291bnQiLCJzaG91bGRNZWFuc1Rlc3QiLCJpIiwicGFydGljaXBhbnQiLCJmb3N0ZXJDaGlsZCIsImNvbnNvbGUiLCJsb2ciLCJzZWN0aW9uIiwicmVxdWlyZWQiLCJpbmRleGVkU2VjdGlvbnMiLCJmaW5kTmV4dCIsImN1cnJlbnRJbmRleCIsIl8iLCJmaW5kSW5kZXgiLCJuZXh0U2VjdGlvbiIsImdvIiwiY29tcGxldGVkIiwiaW5kZXhCeSJdLCJtYXBwaW5ncyI6IkNBQUEsV0FRQSxRQUFBQSxHQUFBQyxJQWlCQSxRQUFBQyxHQUFBQyxFQUFBQyxHQUtBLFFBQUFDLEdBQUFGLEVBQUFDLEdBQ0FBLEVBQUFFLFVBQUEsS0FFQUgsRUFDQUksTUFBQSxTQUNBQyxJQUFBLElBQ0FDLE9BQ0FD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QThELEdBQUFDLEVBQUFDLFVBQUEvRCxFQUFBLFNBQUF5RCxHQUNBLE1BQUFBLEdBQUF0RyxRQUFBNEMsSUFJQXFELEVBQUFTLEVBQUEsRUFBQVQsRUFBQXBELEVBQUFaLE9BQUFnRSxJQUNBLEdBQUFwRCxFQUFBb0QsR0FBQU0sU0FDQSxNQUFBMUQsR0FBQW9ELEdBQUFqRyxLQUtBLE9BQUEsZUFHQSxRQUFBdUIsR0FBQXFCLEdBQ0EsR0FBQWlFLEdBQUFKLEVBQUE3RCxFQUNBM0IsR0FBQTZGLEdBQUFELEdBbkZBLEdBQUFoRSxLQUVBVyxNQUFBLFdBQ0F4RCxNQUFBLFdBQ0ErRyxXQUFBLEVBQ0FSLFVBQUEsSUFHQS9DLE1BQUEsZUFDQXhELE1BQUEsY0FDQStHLFdBQUEsRUFDQVIsVUFBQSxJQUdBL0MsTUFBQSxZQUNBeEQsTUFBQSxZQUNBK0csV0FBQSxFQUNBUixVQUFBLElBR0EvQyxNQUFBLG1CQUNBeEQsTUFBQSxZQUNBK0csV0FBQSxFQUNBUixVQUFBLElBSUFDLEVBQUFHLEVBQUFLLFFBQUFuRSxFQUFBLFNBNERBOEMsR0FDQTlDLFNBQUFBLEVBQ0EyRCxnQkFBQUEsRUFDQWpGLGVBQUFBLEVBQ0FGLHVCQUFBQSxFQUdBLE9BQUFzRSxHQXRHQXBGLFFBQ0FDLE9BQUEsbUJBQ0FtRixRQUFBLFdBQUFDLEdBRUFBLEVBQUFsRixTQUFBIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcblxuICAgIGFuZ3VsYXJcbiAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcsWyduZ01hdGVyaWFsJywndWkucm91dGVyJ10pXG4gICAgICAuY29uZmlnKHJvdXRlckNvbmZpZylcbiAgICAgIC5jb25maWcobWF0ZXJpYWxEZXNpZ25UaGVtZXIpO1xuXG4gICAgbWF0ZXJpYWxEZXNpZ25UaGVtZXIuJGluamVjdCA9IFsnJG1kVGhlbWluZ1Byb3ZpZGVyJ107XG4gICAgZnVuY3Rpb24gbWF0ZXJpYWxEZXNpZ25UaGVtZXIoJG1kVGhlbWluZ1Byb3ZpZGVyKSB7XG4gICAgICAgIC8vICRtZFRoZW1pbmdQcm92aWRlci50aGVtZSgnbGlnaHQtYmx1ZScpO1xuICAgICAgICAvLyAucHJpbWFyeVBhbGV0dGUoJ3BpbmsnLCB7XG4gICAgICAgIC8vICAgJ2RlZmF1bHQnOiAnNDAwJywgLy8gYnkgZGVmYXVsdCB1c2Ugc2hhZGUgNDAwIGZyb20gdGhlIHBpbmsgcGFsZXR0ZSBmb3IgcHJpbWFyeSBpbnRlbnRpb25zXG4gICAgICAgIC8vICAgJ2h1ZS0xJzogJzEwMCcsIC8vIHVzZSBzaGFkZSAxMDAgZm9yIHRoZSA8Y29kZT5tZC1odWUtMTwvY29kZT4gY2xhc3NcbiAgICAgICAgLy8gICAnaHVlLTInOiAnNjAwJywgLy8gdXNlIHNoYWRlIDYwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0yPC9jb2RlPiBjbGFzc1xuICAgICAgICAvLyAgICdodWUtMyc6ICdBMTAwJyAvLyB1c2Ugc2hhZGUgQTEwMCBmb3IgdGhlIDxjb2RlPm1kLWh1ZS0zPC9jb2RlPiBjbGFzc1xuICAgICAgICAvLyB9KVxuICAgICAgICAvLyAvLyBJZiB5b3Ugc3BlY2lmeSBsZXNzIHRoYW4gYWxsIG9mIHRoZSBrZXlzLCBpdCB3aWxsIGluaGVyaXQgZnJvbSB0aGVcbiAgICAgICAgLy8gLy8gZGVmYXVsdCBzaGFkZXNcbiAgICAgICAgLy8gLmFjY2VudFBhbGV0dGUoJ3B1cnBsZScsIHtcbiAgICAgICAgLy8gICAnZGVmYXVsdCc6ICcyMDAnIC8vIHVzZSBzaGFkZSAyMDAgZm9yIGRlZmF1bHQsIGFuZCBrZWVwIGFsbCBvdGhlciBzaGFkZXMgdGhlIHNhbWVcbiAgICAgICAgLy8gfSk7XG4gICAgfVxuXG4gICAgcm91dGVyQ29uZmlnLiRpbmplY3QgPSBbJyRzdGF0ZVByb3ZpZGVyJywgJyR1cmxSb3V0ZXJQcm92aWRlciddO1xuXG4gICAgZnVuY3Rpb24gcm91dGVyQ29uZmlnICgkc3RhdGVQcm92aWRlciwgJHVybFJvdXRlclByb3ZpZGVyKSB7XG5cbiAgICAgICAgcm91dGVyKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpO1xuXG4gICAgICAgIC8vLy8vLy8vLy9cbiAgICAgICAgZnVuY3Rpb24gcm91dGVyKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAgICAgICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcblxuICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXJcbiAgICAgICAgICAgIC5zdGF0ZSgnc3RhcnQnLCB7XG4gICAgICAgICAgICAgICAgdXJsOiAnLycsXG4gICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zdGFydC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5zdGF0ZSgnY2hpbGRyZW4nLCB7XG4gICAgICAgICAgICAgICAgICB1cmw6ICcvY2hpbGRyZW4nLFxuICAgICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9jaGlsZHJlbi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnN0YXRlKCdjaGlsZEluY29tZScsIHtcbiAgICAgICAgICAgICAgICAgIHVybDogJy9jaGlsZEluY29tZScsXG4gICAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lkZU5hdi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2NoaWxkSW5jb21lLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21haW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5zdGF0ZSgnaG91c2Vob2xkJywge1xuICAgICAgICAgICAgICAgICAgdXJsOiAnL2hvdXNlaG9sZCcsXG4gICAgICAgICAgICAgICAgICB2aWV3czp7XG4gICAgICAgICAgICAgICAgICAgICdzaWRlLW5hdic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3Mvc2lkZU5hdi5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdzaWRlTmF2Q29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgJ21haW4nOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2hvdXNlaG9sZC5odG1sJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuc3RhdGUoJ3NpZ25hdHVyZScsIHtcbiAgICAgICAgICAgICAgICAgIHVybDogJy9zaWduYXR1cmUnLFxuICAgICAgICAgICAgICAgICAgdmlld3M6e1xuICAgICAgICAgICAgICAgICAgICAnc2lkZS1uYXYnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL3NpZGVOYXYuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnc2lkZU5hdkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICdtYWluJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWduYXR1cmUuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbWFpbkNvbnRyb2xsZXInXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnN0YXRlKCdjb25maXJtYXRpb24nLCB7XG4gICAgICAgICAgICAgICAgICB1cmw6ICcvY29uZmlybWF0aW9uJyxcbiAgICAgICAgICAgICAgICAgIHZpZXdzOntcbiAgICAgICAgICAgICAgICAgICAgJ3NpZGUtbmF2Jzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWRlTmF2Lmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3NpZGVOYXZDb250cm9sbGVyJ1xuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAnbWFpbic6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnLi4vdmlld3MvY29uZmlybWF0aW9uLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21haW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5zdGF0ZSgnZXhwb3J0Jywge1xuICAgICAgICAgICAgICAgICAgdXJsOiAnL2V4cG9ydCcsXG4gICAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4uL3ZpZXdzL2V4cG9ydC5odG1sJyxcbiAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdtYWluQ29udHJvbGxlcidcbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgLnN0YXRlKCdzdHlsZWd1aWRlJywge1xuICAgICAgICAgICAgICAgICAgdXJsOiAnL3N0eWxlZ3VpZGUnLFxuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zdHlsZWd1aWRlLmh0bWwnLFxuICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ21haW5Db250cm9sbGVyJ1xuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAuc3RhdGUoJ3NpZ251cCcsIHtcbiAgICAgICAgICAgICAgICAgIHVybDogJy9zaWdudXAnLFxuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9zaWdudXAuaHRtbCcsXG4gICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgIC5zdGF0ZSgnbG9naW4nLCB7XG4gICAgICAgICAgICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9sb2dpbi5odG1sJyxcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2VhdENoYWxsZW5nZUFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdtYWluQ29udHJvbGxlcicsIG1haW5Db250cm9sbGVyKTtcblxuICAgIG1haW5Db250cm9sbGVyLiRpbmplY3QgPSBbJyRpbnRlcnZhbCcsICckbWREaWFsb2cnLCAnJG1kTWVkaWEnLCAnJHJvb3RTY29wZScsICckc2NvcGUnLCAnJHN0YXRlJywgJ0hvdXNlaG9sZCcsICdTZWN0aW9ucyddO1xuXG4gICAgZnVuY3Rpb24gbWFpbkNvbnRyb2xsZXIgKCRpbnRlcnZhbCwgJG1kRGlhbG9nLCAkbWRNZWRpYSwgJHNjb3BlLCAkcm9vdFNjb3BlLCAkc3RhdGUsIEhvdXNlaG9sZCwgU2VjdGlvbnMpIHtcbiAgICAgICAgLy8gVE9ETzogcmVwbGFjZSBzY29wZSB3aXRoIHZtXG4gICAgICAgICRzY29wZS5zY2hvb2xEaXN0cmljdCA9ICdPYWtsYW5kIFVuaWZpZWQgU2Nob29sIERpc3RyaWN0JztcbiAgICAgICAgJHNjb3BlLnN0dWRlbnRTdGF0dXNlcyA9IFsnaW4gc2Nob29sJywgJ2hvbWUgc2Nob29sZWQnLCAnc29tZSBvdGhlciBzdGF0dXMnXTtcblxuICAgICAgICAkc2NvcGUuaG91c2Vob2xkID0gSG91c2Vob2xkLmdldCgpO1xuICAgICAgICAkc2NvcGUubmF2aWdhdGVUb05leHRTZWN0aW9uID0gbmF2aWdhdGVUb05leHRTZWN0aW9uO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICAkc2NvcGUuJHdhdGNoKCdob3VzZWhvbGQuY2hpbGRDb3VudCcsIGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgd2hpbGUgKG5ld1ZhbCA+ICRzY29wZS5ob3VzZWhvbGQuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgJHNjb3BlLmhvdXNlaG9sZC5pbmNyZW1lbnRDaGlsZENvdW50KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2goJ2hvdXNlaG9sZC5vdGhlck1lbWJlcnNDb3VudCcsIGZ1bmN0aW9uKG5ld1ZhbCkge1xuICAgICAgICAgICAgd2hpbGUgKG5ld1ZhbCA+ICRzY29wZS5ob3VzZWhvbGQub3RoZXJNZW1iZXJzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICRzY29wZS5ob3VzZWhvbGQuaW5jcmVtZW50T3RoZXJNZW1iZXJzQ291bnQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gVE9ETzogbW92ZSB0aGlzIHRvIGNvbmZpZyBvciBzb21ldGhpbmdcbiAgICAgICAgJHJvb3RTY29wZS4kb24oJyRzdGF0ZUNoYW5nZVN1Y2Nlc3MnLCBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcCA9IDA7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGZ1bmN0aW9uIG5hdmlnYXRlVG9OZXh0U2VjdGlvbigpIHtcbiAgICAgICAgICAgIFNlY3Rpb25zLnVwZGF0ZVJlcXVpcmVkU2VjdGlvbnMoJHNjb3BlLmhvdXNlaG9sZCk7XG4gICAgICAgICAgICBTZWN0aW9ucy5uYXZpZ2F0ZVRvTmV4dCgkc3RhdGUuJGN1cnJlbnQuc2VsZi5uYW1lKTtcbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnKVxuICAgICAgICAuY29udHJvbGxlcignc2lkZU5hdkNvbnRyb2xsZXInLCBzaWRlTmF2Q29udHJvbGxlcik7XG5cbiAgICBzaWRlTmF2Q29udHJvbGxlci4kaW5qZWN0ID0gWyckc2NvcGUnLCAnJHN0YXRlJywgJ1NlY3Rpb25zJ107XG5cbiAgICBmdW5jdGlvbiBzaWRlTmF2Q29udHJvbGxlciAoJHNjb3BlLCAkc3RhdGUsIFNlY3Rpb25zKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gJHNjb3BlO1xuXG4gICAgICAgIHZtLmN1cnJlbnRTdGF0ZSA9ICRzdGF0ZS4kY3VycmVudC5zZWxmLm5hbWU7XG4gICAgICAgIHZtLnNlY3Rpb25zID0gU2VjdGlvbnMuc2VjdGlvbnM7XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnKVxuICAgICAgICAuZGlyZWN0aXZlKCdpbmNvbWVRdWVzdGlvbnMnLCBpbmNvbWVEaXJlY3RpdmUpO1xuXG4gICAgZnVuY3Rpb24gaW5jb21lRGlyZWN0aXZlKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICBtZW1iZXI6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy9pbmNvbWUuaHRtbCcsXG4gICAgICAgICAgICBsaW5rOiBsaW5rXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIGRpcmVjdGl2ZTtcbiAgICB9XG5cbiAgICAvLyBsaW5rLiRpbmplY3QgPSBbJ3Njb3BlJ107XG5cbiAgICBmdW5jdGlvbiBsaW5rKHNjb3BlKSB7XG4gICAgICAgIHNjb3BlLmluY29tZVNvdXJjZXMgPSB7XG4gICAgICAgICAgICB3b3JrOiB7XG4gICAgICAgICAgICAgICAgdmF1bGU6J3dvcmsnLFxuICAgICAgICAgICAgICAgIGxhYmVsOiAnRWFybmluZ3MgZnJvbSB3b3JrJyxcbiAgICAgICAgICAgICAgICBmcmVxdWVuY3k6IFsnd2Vla2x5JywgJ2Jpd2Vla2x5JywgJzJ4IG1vbnRoJywgJ21vbnRobHknXSxcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkOiAnQSBjaGlsZCBoYXMgYSBqb2Igd2hlcmUgdGhleSBlYXJuIHNhbGFyeSBvciB3YWdlcyAnLFxuICAgICAgICAgICAgICAgICAgICBvdGhlck1lbWJlcjogJycsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNvY2lhbFNlY3VyaXR5OiB7XG4gICAgICAgICAgICAgICAgdmF1bGU6J3NvY2lhbFNlY3VyaXR5JyxcbiAgICAgICAgICAgICAgICBsYWJlbDogJ1NvY2lhbCBTZWN1cml0eSBEaXNhYmlsaXR5IFBheW1lbnRzIG9yIFN1cnZpdm9y4oCZcyBCZW5lZml0cyAnLFxuICAgICAgICAgICAgICAgIGZyZXF1ZW5jeTogWydtb250aGx5J10sXG4gICAgICAgICAgICAgICAgYW5ub3RhdGlvbjoge1xuICAgICAgICAgICAgICAgICAgICBjaGlsZDogJ0EgY2hpbGQgaXMgYmxpbmQgb3IgZGlzYWJsZWQgYW5kIHJlY2VpdmVzIFNvY2lhbCBTZWN1cml0eSBiZW5lZml0cy4nLFxuICAgICAgICAgICAgICAgICAgICAvLyAnIEEgcGFyZW50IGlzIGRpc2FibGVkLCByZXRpcmVkLCBvciBkZWNlYXNlZCwgYW5kIHRoZWlyIGNoaWxkIHJlY2VpdmVzIHNvY2lhbCBzZWN1cml0eSBiZW5lZml0cycsXG4gICAgICAgICAgICAgICAgICAgIG90aGVyTWVtYmVyOiAnJyxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3RoZXJQZXJzb246IHtcbiAgICAgICAgICAgICAgICB2YXVsZTonb3RoZXJQZXJzb24nLFxuICAgICAgICAgICAgICAgIGxhYmVsOiAnSW5jb21lIGZyb20gcGVyc29ucyBvdXRzaWRlIHRoZSBob3VzZWhvbGQnLFxuICAgICAgICAgICAgICAgIGZyZXF1ZW5jeTogWyd3ZWVrbHknLCAnYml3ZWVrbHknLCAnMnggbW9udGgnLCAnbW9udGhseSddLFxuICAgICAgICAgICAgICAgIGFubm90YXRpb246IHtcbiAgICAgICAgICAgICAgICAgICAgY2hpbGQ6ICdBIGZyaWVuZCBvciBleHRlbmRlZCBmYW1pbHkgbWVtYmVyIHJlZ3VsYXJseSBnaXZlcyBhIGNoaWxkIHNwZW5kaW5nIG1vbmV5JyxcbiAgICAgICAgICAgICAgICAgICAgb3RoZXJNZW1iZXI6ICcnLFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvdGhlclNvdXJjZToge1xuICAgICAgICAgICAgICAgIHZhdWxlOidvdGhlclNvdXJjZScsXG4gICAgICAgICAgICAgICAgbGFiZWw6ICdJbmNvbWUgZnJvbSBhbnkgb3RoZXIgc291cmNlJyxcbiAgICAgICAgICAgICAgICBmcmVxdWVuY3k6IFsnd2Vla2x5JywgJ2Jpd2Vla2x5JywgJzJ4IG1vbnRoJywgJ21vbnRobHknXSxcbiAgICAgICAgICAgICAgICBhbm5vdGF0aW9uOiB7XG4gICAgICAgICAgICAgICAgICAgIGNoaWxkOiAnQSBjaGlsZCByZWNlaXZlcyBpbmNvbWUgZnJvbSBhIHByaXZhdGUgcGVuc2lvbiBmdW5kLCBhbm51aXR5LCBvciB0cnVzdCcsXG4gICAgICAgICAgICAgICAgICAgIG90aGVyTWVtYmVyOiAnJyxcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKHNjb3BlLm1lbWJlci5pbmNvbWVTb3VyY2VzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgc2NvcGUubWVtYmVyLmluY29tZVNvdXJjZXMgPSBbXTtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHNjb3BlLmluY29tZVNvdXJjZXMpLmZvckVhY2goZnVuY3Rpb24oaW5jb21lU291cmNlKSB7XG4gICAgICAgICAgICAgICAgc2NvcGUubWVtYmVyLmluY29tZVNvdXJjZXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IGluY29tZVNvdXJjZSxcbiAgICAgICAgICAgICAgICAgICAgYW1vdW50OiBudWxsLFxuICAgICAgICAgICAgICAgICAgICBmcmVxdWVuY3k6IG51bGxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnKVxuICAgICAgICAuZGlyZWN0aXZlKCd5ZXNOb0lucHV0JywgeWVzTm9JbnB1dCk7XG5cbiAgICBmdW5jdGlvbiB5ZXNOb0lucHV0ICgpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNjb3BlOiB7XG4gICAgICAgICAgICAgICAgbW9kZWw6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnQScsXG4gICAgICAgICAgICByZXBsYWNlOiB0cnVlLFxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICcuLi92aWV3cy95ZXNuby5odG1sJyxcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnKVxuICAgICAgICAuc2VydmljZSgnSG91c2Vob2xkJywgaG91c2Vob2xkU2VydmljZSk7XG5cbiAgICBob3VzZWhvbGRTZXJ2aWNlLiRpbmplY3QgPSBbJyRodHRwJ107XG5cbiAgICBmdW5jdGlvbiBob3VzZWhvbGRTZXJ2aWNlKCRodHRwKSB7XG4gICAgICAgIHRoaXMuZ2V0ID0gZ2V0O1xuICAgICAgICB0aGlzLnNhdmUgPSBzYXZlO1xuICAgICAgICB0aGlzLmNsZWFyID0gY2xlYXI7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIHZhciBQZXJzb24gPSB7XG4gICAgICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmluY29tZVNvdXJjZUNvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmluY29tZVNvdXJjZXMgPSBbXTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGluY3JlbWVudEluY29tZVNvdXJjZXM6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuaW5jb21lU291cmNlQ291bnQrKztcbiAgICAgICAgICAgICAgICB3aGlsZSAodGhpcy5pbmNvbWVTb3VyY2VDb3VudCA+IHRoaXMuaW5jb21lU291cmNlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5pbmNvbWVTb3VyY2VzLnB1c2goe30pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcblxuICAgICAgICB2YXIgSG91c2Vob2xkID0ge1xuICAgICAgICAgICAgaW5pdDogZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4gPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLmNoaWxkQ291bnQgPSAwO1xuICAgICAgICAgICAgICAgIHRoaXMuaW5jcmVtZW50Q2hpbGRDb3VudCgpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5vdGhlck1lbWJlcnMgPSBbXTtcbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyTWVtYmVyc0NvdW50ID0gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmluY3JlbWVudE90aGVyTWVtYmVyc0NvdW50KCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaW5jcmVtZW50Q2hpbGRDb3VudDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5jaGlsZENvdW50Kys7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMuY2hpbGRDb3VudCA+IHRoaXMuY2hpbGRyZW4ubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXdDaGlsZCA9IE9iamVjdC5jcmVhdGUoUGVyc29uKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGQuaW5pdCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vYWRkIGNoaWxkIHNwZWNpZmljIGZpZWxkc1xuICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZC5pc0NoaWxkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q2hpbGQuc3BlY2lhbFN0YXR1cyA9IHt9O1xuICAgICAgICAgICAgICAgICAgICBuZXdDaGlsZC5hc3Npc3RhbmNlUHJvZ3JhbSA9IHt9O1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2hpbGRyZW4ucHVzaChuZXdDaGlsZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGluY3JlbWVudE90aGVyTWVtYmVyc0NvdW50OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICB0aGlzLm90aGVyTWVtYmVyc0NvdW50Kys7XG4gICAgICAgICAgICAgICAgd2hpbGUgKHRoaXMub3RoZXJNZW1iZXJzQ291bnQgPiB0aGlzLm90aGVyTWVtYmVycy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5ld01lbWJlciA9IE9iamVjdC5jcmVhdGUoUGVyc29uKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3TWVtYmVyLmluaXQoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3TWVtYmVyLmlzQ2hpbGQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5vdGhlck1lbWJlcnMucHVzaChuZXdNZW1iZXIpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9O1xuXG4gICAgICAgIHZhciBob3VzZWhvbGQ7XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0KCkge1xuICAgICAgICAgICAgaWYgKGhvdXNlaG9sZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBob3VzZWhvbGQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vVE9ETzogaWYgdGhlcmUncyBhIHVzZXJpZCwgcmV0dXJuIHRoZSBob3VzZWhvbGQgYXNzb2NpYXRlZCB3aXRoIGl0XG4gICAgICAgICAgICAvLyBpZiAodXNlcmlkKSB7XG4gICAgICAgICAgICAvLyAgICAgLy8gVE9ETzogYWRkIGVycm9yIGhhbmRsaW5nXG4gICAgICAgICAgICAvLyAgICAgJGh0dHAuZ2V0KCcvaG91c2Vob2xkJykudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAvLyAgICAgICAgIHJldHVybiBob3VzZWhvbGQgPSBkYXRhO1xuICAgICAgICAgICAgLy8gICAgIH0pO1xuICAgICAgICAgICAgLy8gfSBlbHNlIHtcbiAgICAgICAgICAgIC8vICAgICAvLyBjcmVhdGUgYSBuZXcgaG91c2Vob2xkIGlmIG9uZSBkb2Vzbid0IGV4aXN0XG4gICAgICAgICAgICBob3VzZWhvbGQgPSBPYmplY3QuY3JlYXRlKEhvdXNlaG9sZCk7XG4gICAgICAgICAgICBob3VzZWhvbGQuaW5pdCgpO1xuICAgICAgICAgICAgLy8gfVxuXG4gICAgICAgICAgICByZXR1cm4gaG91c2Vob2xkO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZSgpIHtcbiAgICAgICAgICAgIC8vIFRPRE86IGhhbmRsZSBlcnJvcnNcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCcvaG91c2Vob2xkJywgaG91c2Vob2xkKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyICgpIHtcbiAgICAgICAgICAgIHZhciBob3VzZWhvbGQgPSB7fTtcbiAgICAgICAgICAgIHJldHVybiBob3VzZWhvbGQ7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdlYXRDaGFsbGVuZ2VBcHAnKVxuICAgICAgICAuc2VydmljZSgnU2VjdGlvbnMnLCBzZWN0aW9uc1NlcnZpY2UpO1xuXG4gICAgc2VjdGlvbnNTZXJ2aWNlLiRpbmplY3QgPSBbJyRzdGF0ZSddO1xuXG4gICAgZnVuY3Rpb24gc2VjdGlvbnNTZXJ2aWNlKCRzdGF0ZSkge1xuXG4gICAgICAgIHZhciBzZWN0aW9ucyA9IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ0NoaWxkcmVuJyxcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2NoaWxkcmVuJyxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnQ2hpbGQgSW5jb21lJyxcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2NoaWxkSW5jb21lJyxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGxhYmVsOiAnSG91c2Vob2xkJyxcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2hvdXNlaG9sZCcsXG4gICAgICAgICAgICAgICAgY29tcGxldGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBsYWJlbDogJ1NpZ24gYW5kIENvbmZpcm0nLFxuICAgICAgICAgICAgICAgIHN0YXRlOiAnc2lnbmF0dXJlJyxcbiAgICAgICAgICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgICAgICB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIHZhciBpbmRleGVkU2VjdGlvbnMgPSBfLmluZGV4Qnkoc2VjdGlvbnMsICdzdGF0ZScpO1xuXG4gICAgICAgIC8vIFRPRE86IFB1dCBza2lwIGxvZ2ljIGhlcmVcbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlUmVxdWlyZWRTZWN0aW9ucyhob3VzZWhvbGQpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50Q2hpbGQ7XG4gICAgICAgICAgICB2YXIgYXNzaXN0YW5jZVByb2dyYW1Ib3VzZWhvbGQgPSBmYWxzZTtcbiAgICAgICAgICAgIHZhciBmb3N0ZXJDaGlsZENvdW50ID0gMDtcbiAgICAgICAgICAgIHZhciBzaG91bGRNZWFuc1Rlc3QgPSB0cnVlO1xuXG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCA7IGkgPCBob3VzZWhvbGQuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50Q2hpbGQgPSBob3VzZWhvbGQuY2hpbGRyZW5baV07XG5cbiAgICAgICAgICAgICAgICBpZiAoY3VycmVudENoaWxkLmFzc2lzdGFuY2VQcm9ncmFtLnBhcnRpY2lwYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIGFzc2lzdGFuY2VQcm9ncmFtSG91c2Vob2xkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRDaGlsZC5zcGVjaWFsU3RhdHVzLmZvc3RlckNoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvc3RlckNoaWxkQ291bnQrKztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChhc3Npc3RhbmNlUHJvZ3JhbUhvdXNlaG9sZCB8fFxuICAgICAgICAgICAgICAgIGhvdXNlaG9sZC5jaGlsZHJlbi5sZW5ndGggPT09IGZvc3RlckNoaWxkQ291bnQpIHtcbiAgICAgICAgICAgICAgICBzaG91bGRNZWFuc1Rlc3QgPSBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKHtzaG91bGRNZWFuc1Rlc3Q6IHNob3VsZE1lYW5zVGVzdH0pO1xuICAgICAgICAgICAgaWYgKHNob3VsZE1lYW5zVGVzdCkge1xuICAgICAgICAgICAgICAgIHNlY3Rpb25zLmZvckVhY2goZnVuY3Rpb24oc2VjdGlvbikge1xuICAgICAgICAgICAgICAgICAgICBzZWN0aW9uLnJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5kZXhlZFNlY3Rpb25zWydjaGlsZEluY29tZSddLnJlcXVpcmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgaW5kZXhlZFNlY3Rpb25zWydob3VzZWhvbGQnXS5yZXF1aXJlZCA9IGZhbHNlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBmaW5kTmV4dChjdXJyZW50U3RhdGUpIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50SW5kZXggPSBfLmZpbmRJbmRleChzZWN0aW9ucywgZnVuY3Rpb24oc2VjdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybiBzZWN0aW9uLnN0YXRlID09PSBjdXJyZW50U3RhdGU7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gTG9vayBmb3IgdGhlIG5leHQgcmVxdWlyZWQgc2VjdGlvblxuICAgICAgICAgICAgZm9yICh2YXIgaSA9IGN1cnJlbnRJbmRleCArIDE7IGkgPCBzZWN0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChzZWN0aW9uc1tpXS5yZXF1aXJlZCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VjdGlvbnNbaV0uc3RhdGU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBpZiB0aGVyZSBhcmUgbm8gbW9yZSByZXF1aXJlZCBzZWN0aW9ucywgd2UncmUgZG9uZS5cbiAgICAgICAgICAgIHJldHVybiAnY29uZmlybWF0aW9uJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG5hdmlnYXRlVG9OZXh0KGN1cnJlbnRTdGF0ZSkge1xuICAgICAgICAgICAgdmFyIG5leHRTZWN0aW9uICA9IGZpbmROZXh0KGN1cnJlbnRTdGF0ZSk7XG4gICAgICAgICAgICAkc3RhdGUuZ28obmV4dFNlY3Rpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIHNlY3Rpb25zOiBzZWN0aW9ucyxcbiAgICAgICAgICAgIGluZGV4ZWRTZWN0aW9uczogaW5kZXhlZFNlY3Rpb25zLFxuICAgICAgICAgICAgbmF2aWdhdGVUb05leHQ6IG5hdmlnYXRlVG9OZXh0LFxuICAgICAgICAgICAgdXBkYXRlUmVxdWlyZWRTZWN0aW9uczogdXBkYXRlUmVxdWlyZWRTZWN0aW9uc1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgfVxuXG59KSgpO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
